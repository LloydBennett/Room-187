<% 

let gallery = document.data.gallery
const checkEmptyItem = (item) =>
(!item.media || Object.keys(item.media).length === 1 && item.media.link_type === 'Media')
    
const isGalleryEmpty = gallery.length > 0 && gallery.every(checkEmptyItem)

console.log(gallery)

%>

<div class="container <% if(!isGalleryEmpty){%>gallery-grid<%} else {%>grid<%}%>" data-gallery>
  <% if(gallery.length !== 0 && !isGalleryEmpty) { %>
    <% gallery.forEach((item, i) => { %>
      <% 
        let isItemEmpty = checkEmptyItem(item) 
        let isSlideShowEmpty = Object.keys(item.slideshow_image).length === 0

        console.log(item.slideshow_image.length)
      %>
      <% if(!isItemEmpty) { %>
        <% if(item.media.kind === "file") { %>
          <div class="gallery-grid__item">
            <div class="thumbnail">
              <video data-gallery-item="video" data-gallery-id="<%- item.media.id %>" autoplay muted loop>
                <source src="<%- item.media.url %>" type="video/mp4" />
              </video>
            </div>
          </div>
        <% } else { %>
          <% if(!isSlideShowEmpty) { %>
            <div class="gallery-grid__item">
              <div class="thumbnail">
                <img src="<%- item.media.url %>" alt="<%- item.media.alt %>" class="thumbnail" data-gallery-item="image" data-gallery-src="<%- item.slideshow_image.url %>" data-gallery-id="<%- item.media.id %>">
              </div>
            </div>
          <% } %>
        <% } %>
        
      <% } %>

    <% }) %>

    <div class="fixed cannot-interact bg--black overlay overlay--reveal flex--middle z-index--5" data-slideshow data-lenis-prevent>
      <%- include('../partials/close-button') -%>
      <div class="slideshow__media thumbnail" data-slideshow-container></div>

      <div class="slideshow__controls slideshow__prev thumbnail__inline" data-slideshow-prev>
        <%- include('../partials/svg/carousel-button') -%>
      </div>
      <div class="slideshow__controls slideshow__next thumbnail__inline" data-slideshow-next>
        <%- include('../partials/svg/carousel-button') -%>
      </div>
    </div>

  <%} else { %>
    <div class="column--centered text-center section--l-m-b" data-hero>
      <h1 class="type--white type--caps type--display type--xl type--x-bold type--l-margin" data-split-text>
        Nothing Here&hellip;&nbsp;Yet!</span>
      </h1>
      <p class="type--xs type--white" data-split-text>New drops, dope visuals, and all the good stuff you love are on the way. Check back soon, it&apos;s gonna be worth the wait!</p>
      <div class="button--m-t" data-misc>
        <%- include('../partials/button', { buttonText: "Back to the room", link: "/", link_target: false, large: true, primaryBtn: true, fullWidth: false }) -%>
      </div>
    </div>
    
  <% } %>
  
</div>

