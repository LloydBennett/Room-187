"use strict";
self["webpackHotUpdateroom187"]("main",{

/***/ "./app/components/Carousel.js":
/*!************************************!*\
  !*** ./app/components/Carousel.js ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ Carousel)
/* harmony export */ });
/* harmony import */ var classes_Components__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! classes/Components */ "./app/classes/Components.js");
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gsap */ "./node_modules/gsap/index.js");


class Carousel extends classes_Components__WEBPACK_IMPORTED_MODULE_0__["default"] {
  constructor() {
    super({
      elements: {
        carousel: '[data-carousel]'
      }
    });
    this.init();
  }
  create() {
    super.create();
  }
  init() {
    if (this.elements.carousel === null) return;
    let carousels = [];
    if (this.elements.carousel instanceof NodeList || Array.isArray(this.elements.carousel)) {
      carousels = Array.from(this.elements.carousel);
    } else {
      carousels = [this.elements.carousel];
    }
    carousels.forEach(c => this.setCarouselType(c));
  }
  setCarouselType(carousel) {
    const type = carousel.getAttribute('data-carousel');
    const wrapper = carousel.closest('[data-carousel-wrapper]');
    let progressEl = null;
    if (wrapper) {
      const indicator = wrapper.querySelector('[data-carousel-indicator]');
      const progress = wrapper.querySelector('[data-carousel-progress]');
      if (indicator && progress) progressEl = progress;
    }
    this.enableDraggableCarousel(carousel, progressEl);

    // add extra behavior if requested
    if (type === "motion") {
      this.enableRotations(carousel);
    }
  }
  enableDraggableCarousel(carousel, progressEl = null) {
    let isDragging = false;
    let startX = 0;
    let lastX = 0;
    let velocity = 0;
    let rafId = null;
    const items = carousel.querySelectorAll('[data-carousel-item]');
    if (!items.length) return;
    const friction = 0.925;
    const speedMultiplier = 1.35;
    const updateProgress = () => {
      if (!progressEl) return;
      const scrollLeft = carousel.scrollLeft;
      const maxScroll = carousel.scrollWidth - carousel.clientWidth;
      const percent = Math.min(Math.max(scrollLeft / maxScroll * 100, 0), 100);
      gsap__WEBPACK_IMPORTED_MODULE_1__["default"].to(progressEl, {
        width: `${percent}%`,
        duration: 0.15,
        ease: 'power2.out'
      });
    };
    const snapToNearestItem = () => {
      if (!items.length) return;
      let nearestIndex = 0;
      let minDistance = Infinity;
      items.forEach((item, index) => {
        const distance = Math.abs(carousel.scrollLeft - item.offsetLeft);
        if (distance < minDistance) {
          minDistance = distance;
          nearestIndex = index;
        }
      });
      const paddingLeft = parseFloat(getComputedStyle(carousel).paddingLeft) || 0;
      const targetScrollLeft = items[nearestIndex].offsetLeft - paddingLeft;
      gsap__WEBPACK_IMPORTED_MODULE_1__["default"].to(carousel, {
        scrollLeft: targetScrollLeft,
        duration: 0.4,
        ease: 'power3.out',
        onUpdate: updateProgress,
        onComplete: updateProgress
      });
    };
    const inertiaLoop = () => {
      if (Math.abs(velocity) < 0.2) return;
      carousel.scrollLeft -= velocity;
      updateProgress();
      velocity *= friction;
      rafId = requestAnimationFrame(inertiaLoop);
    };
    const startDrag = e => {
      if (e.type === 'mousedown' && e.button !== 0) return;
      isDragging = true;
      carousel.classList.add('is-dragging');
      startX = e.type.includes('mouse') ? e.pageX : e.touches[0].pageX;
      lastX = startX;
      cancelAnimationFrame(rafId);
    };
    const onDrag = e => {
      if (!isDragging) return;
      const x = e.type.includes('mouse') ? e.pageX : e.touches[0].pageX;
      const delta = (x - lastX) * speedMultiplier;
      carousel.scrollLeft -= delta;
      velocity = delta;
      lastX = x;

      // Desktop: update progress live
      if (window.innerWidth > 768) updateProgress();
    };
    const endDrag = () => {
      isDragging = false;
      carousel.classList.remove('is-dragging');
      if (window.innerWidth <= 768) {
        snapToNearestItem();
      } else {
        inertiaLoop();
      }
    };

    // Events
    carousel.addEventListener('mousedown', startDrag);
    window.addEventListener('mousemove', onDrag);
    window.addEventListener('mouseup', endDrag);
    carousel.addEventListener('touchstart', startDrag, {
      passive: true
    });
    window.addEventListener('touchmove', onDrag, {
      passive: false
    });
    window.addEventListener('touchend', endDrag);
    window.addEventListener('resize', updateProgress);

    // Initial progress update
    updateProgress();
  }
  enableRotations(carousel) {
    const items = carousel.querySelectorAll("[data-carousel-item]");
    if (!items.length) return;
    const rotationIntensity = 0.04;
    const resetRotation = () => {
      items.forEach(item => {
        gsap__WEBPACK_IMPORTED_MODULE_1__["default"].to(item, {
          rotationZ: 0,
          duration: 0.6,
          ease: "power3.out",
          overwrite: true
        });
      });
    };
    const updateItemRotations = (v, isDragging) => {
      items.forEach((item, index) => {
        const factor = (index + 1) / items.length;
        const rotateZ = gsap__WEBPACK_IMPORTED_MODULE_1__["default"].utils.clamp(-2, 2, v * rotationIntensity * factor);
        gsap__WEBPACK_IMPORTED_MODULE_1__["default"].to(item, {
          rotationZ: rotateZ,
          duration: isDragging ? 0.1 : 0.4,
          ease: "power2.out",
          overwrite: true
        });
      });
    };

    // hook into dragging lifecycle
    carousel.addEventListener("carousel:drag", e => {
      updateItemRotations(e.detail.velocity, e.detail.isDragging);
    });
    carousel.addEventListener("carousel:end", () => {
      resetRotation();
    });
  }
}

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("749334764fe2b1f50da1")
/******/ })();
/******/ 
/******/ }
);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5kNzJiNzNlZjQ4ZWZiNTQ1Y2VlYi5ob3QtdXBkYXRlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUEyQztBQUNwQjtBQUVSLE1BQU1FLFFBQVEsU0FBU0YsMERBQVUsQ0FBQztFQUMvQ0csV0FBV0EsQ0FBQSxFQUFHO0lBQ1osS0FBSyxDQUFDO01BQ0pDLFFBQVEsRUFBRTtRQUNSQyxRQUFRLEVBQUU7TUFDWjtJQUNGLENBQUMsQ0FBQztJQUVGLElBQUksQ0FBQ0MsSUFBSSxDQUFDLENBQUM7RUFDYjtFQUVBQyxNQUFNQSxDQUFBLEVBQUc7SUFDUCxLQUFLLENBQUNBLE1BQU0sQ0FBQyxDQUFDO0VBQ2hCO0VBRUFELElBQUlBLENBQUEsRUFBRztJQUNMLElBQUksSUFBSSxDQUFDRixRQUFRLENBQUNDLFFBQVEsS0FBSyxJQUFJLEVBQUU7SUFFckMsSUFBSUcsU0FBUyxHQUFHLEVBQUU7SUFFbEIsSUFBSSxJQUFJLENBQUNKLFFBQVEsQ0FBQ0MsUUFBUSxZQUFZSSxRQUFRLElBQUlDLEtBQUssQ0FBQ0MsT0FBTyxDQUFDLElBQUksQ0FBQ1AsUUFBUSxDQUFDQyxRQUFRLENBQUMsRUFBRTtNQUN2RkcsU0FBUyxHQUFHRSxLQUFLLENBQUNFLElBQUksQ0FBQyxJQUFJLENBQUNSLFFBQVEsQ0FBQ0MsUUFBUSxDQUFDO0lBQ2hELENBQUMsTUFDSTtNQUNIRyxTQUFTLEdBQUcsQ0FBQyxJQUFJLENBQUNKLFFBQVEsQ0FBQ0MsUUFBUSxDQUFDO0lBQ3RDO0lBRUFHLFNBQVMsQ0FBQ0ssT0FBTyxDQUFDQyxDQUFDLElBQUksSUFBSSxDQUFDQyxlQUFlLENBQUNELENBQUMsQ0FBQyxDQUFDO0VBQ2pEO0VBRUFDLGVBQWVBLENBQUNWLFFBQVEsRUFBRTtJQUN4QixNQUFNVyxJQUFJLEdBQUdYLFFBQVEsQ0FBQ1ksWUFBWSxDQUFDLGVBQWUsQ0FBQztJQUNuRCxNQUFNQyxPQUFPLEdBQUdiLFFBQVEsQ0FBQ2MsT0FBTyxDQUFDLHlCQUF5QixDQUFDO0lB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TUFDaERxQixtQkFBbUIsQ0FBQ3JCLENBQUMsQ0FBQzJCLE1BQU0sQ0FBQ2pFLFFBQVEsRUFBRXNDLENBQUMsQ0FBQzJCLE1BQU0sQ0FBQ3BFLFVBQVUsQ0FBQztJQUM3RCxDQUFDLENBQUM7SUFFRnJCLFFBQVEsQ0FBQzZFLGdCQUFnQixDQUFDLGNBQWMsRUFBRSxNQUFNO01BQzlDRyxhQUFhLENBQUMsQ0FBQztJQUNqQixDQUFDLENBQUM7RUFDSjtBQUNGLEM7Ozs7Ozs7O1VDaE1BLHNEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcm9vbTE4Ny8uL2FwcC9jb21wb25lbnRzL0Nhcm91c2VsLmpzIiwid2VicGFjazovL3Jvb20xODcvd2VicGFjay9ydW50aW1lL2dldEZ1bGxIYXNoIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDb21wb25lbnRzIGZyb20gJ2NsYXNzZXMvQ29tcG9uZW50cydcbmltcG9ydCBnc2FwIGZyb20gJ2dzYXAnXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcm91c2VsIGV4dGVuZHMgQ29tcG9uZW50cyB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKHtcbiAgICAgIGVsZW1lbnRzOiB7XG4gICAgICAgIGNhcm91c2VsOiAnW2RhdGEtY2Fyb3VzZWxdJ1xuICAgICAgfVxuICAgIH0pXG5cbiAgICB0aGlzLmluaXQoKVxuICB9XG5cbiAgY3JlYXRlKCkge1xuICAgIHN1cGVyLmNyZWF0ZSgpXG4gIH1cblxuICBpbml0KCkge1xuICAgIGlmICh0aGlzLmVsZW1lbnRzLmNhcm91c2VsID09PSBudWxsKSByZXR1cm5cblxuICAgIGxldCBjYXJvdXNlbHMgPSBbXVxuXG4gICAgaWYgKHRoaXMuZWxlbWVudHMuY2Fyb3VzZWwgaW5zdGFuY2VvZiBOb2RlTGlzdCB8fCBBcnJheS5pc0FycmF5KHRoaXMuZWxlbWVudHMuY2Fyb3VzZWwpKSB7XG4gICAgICBjYXJvdXNlbHMgPSBBcnJheS5mcm9tKHRoaXMuZWxlbWVudHMuY2Fyb3VzZWwpXG4gICAgfSBcbiAgICBlbHNlIHtcbiAgICAgIGNhcm91c2VscyA9IFt0aGlzLmVsZW1lbnRzLmNhcm91c2VsXVxuICAgIH1cblxuICAgIGNhcm91c2Vscy5mb3JFYWNoKGMgPT4gdGhpcy5zZXRDYXJvdXNlbFR5cGUoYykpXG4gIH1cblxuICBzZXRDYXJvdXNlbFR5cGUoY2Fyb3VzZWwpIHtcbiAgICBjb25zdCB0eXBlID0gY2Fyb3VzZWwuZ2V0QXR0cmlidXRlKCdkYXRhLWNhcm91c2VsJylcbiAgICBjb25zdCB3cmFwcGVyID0gY2Fyb3VzZWwuY2xvc2VzdCgnW2RhdGEtY2Fyb3VzZWwtd3JhcHBlcl0nKVxuICAgIGxldCBwcm9ncmVzc0VsID0gbnVsbFxuXG4gICAgaWYgKHdyYXBwZXIpIHtcbiAgICAgIGNvbnN0IGluZGljYXRvciA9IHdyYXBwZXIucXVlcnlTZWxlY3RvcignW2RhdGEtY2Fyb3VzZWwtaW5kaWNhdG9yXScpXG4gICAgICBjb25zdCBwcm9ncmVzcyA9IHdyYXBwZXIucXVlcnlTZWxlY3RvcignW2RhdGEtY2Fyb3VzZWwtcHJvZ3Jlc3NdJylcbiAgICAgIGlmIChpbmRpY2F0b3IgJiYgcHJvZ3Jlc3MpIHByb2dyZXNzRWwgPSBwcm9ncmVzc1xuICAgIH1cblxuICAgIHRoaXMuZW5hYmxlRHJhZ2dhYmxlQ2Fyb3VzZWwoY2Fyb3VzZWwsIHByb2dyZXNzRWwpXG5cbiAgICAvLyBhZGQgZXh0cmEgYmVoYXZpb3IgaWYgcmVxdWVzdGVkXG4gICAgaWYgKHR5cGUgPT09IFwibW90aW9uXCIpIHtcbiAgICAgIHRoaXMuZW5hYmxlUm90YXRpb25zKGNhcm91c2VsKVxuICAgIH0gICAgXG4gIH1cblxuICBlbmFibGVEcmFnZ2FibGVDYXJvdXNlbChjYXJvdXNlbCwgcHJvZ3Jlc3NFbCA9IG51bGwpIHtcbiAgICBsZXQgaXNEcmFnZ2luZyA9IGZhbHNlXG4gICAgbGV0IHN0YXJ0WCA9IDBcbiAgICBsZXQgbGFzdFggPSAwXG4gICAgbGV0IHZlbG9jaXR5ID0gMFxuICAgIGxldCByYWZJZCA9IG51bGxcbiAgICBjb25zdCBpdGVtcyA9IGNhcm91c2VsLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWNhcm91c2VsLWl0ZW1dJylcbiAgICBpZiAoIWl0ZW1zLmxlbmd0aCkgcmV0dXJuXG5cbiAgICBjb25zdCBmcmljdGlvbiA9IDAuOTI1XG4gICAgY29uc3Qgc3BlZWRNdWx0aXBsaWVyID0gMS4zNVxuXG4gICAgY29uc3QgdXBkYXRlUHJvZ3Jlc3MgPSAoKSA9PiB7XG4gICAgICBpZiAoIXByb2dyZXNzRWwpIHJldHVyblxuICAgICAgY29uc3Qgc2Nyb2xsTGVmdCA9IGNhcm91c2VsLnNjcm9sbExlZnRcbiAgICAgIGNvbnN0IG1heFNjcm9sbCA9IGNhcm91c2VsLnNjcm9sbFdpZHRoIC0gY2Fyb3VzZWwuY2xpZW50V2lkdGhcbiAgICAgIGNvbnN0IHBlcmNlbnQgPSBNYXRoLm1pbihNYXRoLm1heCgoc2Nyb2xsTGVmdCAvIG1heFNjcm9sbCkgKiAxMDAsIDApLCAxMDApXG4gICAgICBnc2FwLnRvKHByb2dyZXNzRWwsIHsgd2lkdGg6IGAke3BlcmNlbnR9JWAsIGR1cmF0aW9uOiAwLjE1LCBlYXNlOiAncG93ZXIyLm91dCcgfSlcbiAgICB9XG5cbiAgICBjb25zdCBzbmFwVG9OZWFyZXN0SXRlbSA9ICgpID0+IHtcbiAgICAgIGlmICghaXRlbXMubGVuZ3RoKSByZXR1cm5cbiAgICAgIGxldCBuZWFyZXN0SW5kZXggPSAwXG4gICAgICBsZXQgbWluRGlzdGFuY2UgPSBJbmZpbml0eVxuXG4gICAgICBpdGVtcy5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xuICAgICAgICBjb25zdCBkaXN0YW5jZSA9IE1hdGguYWJzKGNhcm91c2VsLnNjcm9sbExlZnQgLSBpdGVtLm9mZnNldExlZnQpXG4gICAgICAgIGlmIChkaXN0YW5jZSA8IG1pbkRpc3RhbmNlKSB7XG4gICAgICAgICAgbWluRGlzdGFuY2UgPSBkaXN0YW5jZVxuICAgICAgICAgIG5lYXJlc3RJbmRleCA9IGluZGV4XG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIGNvbnN0IHBhZGRpbmdMZWZ0ID0gcGFyc2VGbG9hdChnZXRDb21wdXRlZFN0eWxlKGNhcm91c2VsKS5wYWRkaW5nTGVmdCkgfHwgMFxuICAgICAgY29uc3QgdGFyZ2V0U2Nyb2xsTGVmdCA9IGl0ZW1zW25lYXJlc3RJbmRleF0ub2Zmc2V0TGVmdCAtIHBhZGRpbmdMZWZ0XG5cbiAgICAgIGdzYXAudG8oY2Fyb3VzZWwsIHtcbiAgICAgICAgc2Nyb2xsTGVmdDogdGFyZ2V0U2Nyb2xsTGVmdCxcbiAgICAgICAgZHVyYXRpb246IDAuNCxcbiAgICAgICAgZWFzZTogJ3Bvd2VyMy5vdXQnLFxuICAgICAgICBvblVwZGF0ZTogdXBkYXRlUHJvZ3Jlc3MsXG4gICAgICAgIG9uQ29tcGxldGU6IHVwZGF0ZVByb2dyZXNzXG4gICAgICB9KVxuICAgIH1cblxuICAgIGNvbnN0IGluZXJ0aWFMb29wID0gKCkgPT4ge1xuICAgICAgaWYgKE1hdGguYWJzKHZlbG9jaXR5KSA8IDAuMikgcmV0dXJuXG4gICAgICBjYXJvdXNlbC5zY3JvbGxMZWZ0IC09IHZlbG9jaXR5XG4gICAgICB1cGRhdGVQcm9ncmVzcygpXG4gICAgICB2ZWxvY2l0eSAqPSBmcmljdGlvblxuICAgICAgcmFmSWQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoaW5lcnRpYUxvb3ApXG4gICAgfVxuXG4gICAgY29uc3Qgc3RhcnREcmFnID0gKGUpID0+IHtcbiAgICAgIGlmIChlLnR5cGUgPT09ICdtb3VzZWRvd24nICYmIGUuYnV0dG9uICE9PSAwKSByZXR1cm5cbiAgICAgIGlzRHJhZ2dpbmcgPSB0cnVlXG4gICAgICBjYXJvdXNlbC5jbGFzc0xpc3QuYWRkKCdpcy1kcmFnZ2luZycpXG4gICAgICBzdGFydFggPSBlLnR5cGUuaW5jbHVkZXMoJ21vdXNlJykgPyBlLnBhZ2VYIDogZS50b3VjaGVzWzBdLnBhZ2VYXG4gICAgICBsYXN0WCA9IHN0YXJ0WFxuICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUocmFmSWQpXG4gICAgfVxuXG4gICAgY29uc3Qgb25EcmFnID0gKGUpID0+IHtcbiAgICAgIGlmICghaXNEcmFnZ2luZykgcmV0dXJuXG4gICAgICBjb25zdCB4ID0gZS50eXBlLmluY2x1ZGVzKCdtb3VzZScpID8gZS5wYWdlWCA6IGUudG91Y2hlc1swXS5wYWdlWFxuICAgICAgY29uc3QgZGVsdGEgPSAoeCAtIGxhc3RYKSAqIHNwZWVkTXVsdGlwbGllclxuICAgICAgY2Fyb3VzZWwuc2Nyb2xsTGVmdCAtPSBkZWx0YVxuICAgICAgdmVsb2NpdHkgPSBkZWx0YVxuICAgICAgbGFzdFggPSB4XG5cbiAgICAgIC8vIERlc2t0b3A6IHVwZGF0ZSBwcm9ncmVzcyBsaXZlXG4gICAgICBpZiAod2luZG93LmlubmVyV2lkdGggPiA3NjgpIHVwZGF0ZVByb2dyZXNzKClcbiAgICB9XG5cbiAgICBjb25zdCBlbmREcmFnID0gKCkgPT4ge1xuICAgICAgaXNEcmFnZ2luZyA9IGZhbHNlXG4gICAgICBjYXJvdXNlbC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1kcmFnZ2luZycpXG5cbiAgICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA8PSA3NjgpIHtcbiAgICAgICAgc25hcFRvTmVhcmVzdEl0ZW0oKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaW5lcnRpYUxvb3AoKVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEV2ZW50c1xuICAgIGNhcm91c2VsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHN0YXJ0RHJhZylcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgb25EcmFnKVxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgZW5kRHJhZylcblxuICAgIGNhcm91c2VsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBzdGFydERyYWcsIHsgcGFzc2l2ZTogdHJ1ZSB9KVxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBvbkRyYWcsIHsgcGFzc2l2ZTogZmFsc2UgfSlcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBlbmREcmFnKVxuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHVwZGF0ZVByb2dyZXNzKVxuXG4gICAgLy8gSW5pdGlhbCBwcm9ncmVzcyB1cGRhdGVcbiAgICB1cGRhdGVQcm9ncmVzcygpXG4gIH1cblxuICBlbmFibGVSb3RhdGlvbnMoY2Fyb3VzZWwpIHtcbiAgICBjb25zdCBpdGVtcyA9IGNhcm91c2VsLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbZGF0YS1jYXJvdXNlbC1pdGVtXVwiKVxuICAgIGlmICghaXRlbXMubGVuZ3RoKSByZXR1cm5cblxuICAgIGNvbnN0IHJvdGF0aW9uSW50ZW5zaXR5ID0gMC4wNFxuXG4gICAgY29uc3QgcmVzZXRSb3RhdGlvbiA9ICgpID0+IHtcbiAgICAgIGl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgIGdzYXAudG8oaXRlbSwge1xuICAgICAgICAgIHJvdGF0aW9uWjogMCxcbiAgICAgICAgICBkdXJhdGlvbjogMC42LFxuICAgICAgICAgIGVhc2U6IFwicG93ZXIzLm91dFwiLFxuICAgICAgICAgIG92ZXJ3cml0ZTogdHJ1ZVxuICAgICAgICB9KVxuICAgICAgfSlcbiAgICB9XG5cbiAgICBjb25zdCB1cGRhdGVJdGVtUm90YXRpb25zID0gKHYsIGlzRHJhZ2dpbmcpID0+IHtcbiAgICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgIGNvbnN0IGZhY3RvciA9IChpbmRleCArIDEpIC8gaXRlbXMubGVuZ3RoXG4gICAgICAgIGNvbnN0IHJvdGF0ZVogPSBnc2FwLnV0aWxzLmNsYW1wKC0yLCAyLCB2ICogcm90YXRpb25JbnRlbnNpdHkgKiBmYWN0b3IpXG5cbiAgICAgICAgZ3NhcC50byhpdGVtLCB7XG4gICAgICAgICAgcm90YXRpb25aOiByb3RhdGVaLFxuICAgICAgICAgIGR1cmF0aW9uOiBpc0RyYWdnaW5nID8gMC4xIDogMC40LFxuICAgICAgICAgIGVhc2U6IFwicG93ZXIyLm91dFwiLFxuICAgICAgICAgIG92ZXJ3cml0ZTogdHJ1ZVxuICAgICAgICB9KVxuICAgICAgfSlcbiAgICB9XG5cbiAgICAvLyBob29rIGludG8gZHJhZ2dpbmcgbGlmZWN5Y2xlXG4gICAgY2Fyb3VzZWwuYWRkRXZlbnRMaXN0ZW5lcihcImNhcm91c2VsOmRyYWdcIiwgKGUpID0+IHtcbiAgICAgIHVwZGF0ZUl0ZW1Sb3RhdGlvbnMoZS5kZXRhaWwudmVsb2NpdHksIGUuZGV0YWlsLmlzRHJhZ2dpbmcpXG4gICAgfSlcblxuICAgIGNhcm91c2VsLmFkZEV2ZW50TGlzdGVuZXIoXCJjYXJvdXNlbDplbmRcIiwgKCkgPT4ge1xuICAgICAgcmVzZXRSb3RhdGlvbigpXG4gICAgfSlcbiAgfVxufSIsIl9fd2VicGFja19yZXF1aXJlX18uaCA9ICgpID0+IChcIjc0OTMzNDc2NGZlMmIxZjUwZGExXCIpIl0sIm5hbWVzIjpbIkNvbXBvbmVudHMiLCJnc2FwIiwiQ2Fyb3VzZWwiLCJjb25zdHJ1Y3RvciIsImVsZW1lbnRzIiwiY2Fyb3VzZWwiLCJpbml0IiwiY3JlYXRlIiwiY2Fyb3VzZWxzIiwiTm9kZUxpc3QiLCJBcnJheSIsImlzQXJyYXkiLCJmcm9tIiwiZm9yRWFjaCIsImMiLCJzZXRDYXJvdXNlbFR5cGUiLCJ0eXBlIiwiZ2V0QXR0cmlidXRlIiwid3JhcHBlciIsImNsb3Nlc3QiLCJwcm9ncmVzc0VsIiwiaW5kaWNhdG9yIiwicXVlcnlTZWxlY3RvciIsInByb2dyZXNzIiwiZW5hYmxlRHJhZ2dhYmxlQ2Fyb3VzZWwiLCJlbmFibGVSb3RhdGlvbnMiLCJpc0RyYWdnaW5nIiwic3RhcnRYIiwibGFzdFgiLCJ2ZWxvY2l0eSIsInJhZklkIiwiaXRlbXMiLCJxdWVyeVNlbGVjdG9yQWxsIiwibGVuZ3RoIiwiZnJpY3Rpb24iLCJzcGVlZE11bHRpcGxpZXIiLCJ1cGRhdGVQcm9ncmVzcyIsInNjcm9sbExlZnQiLCJtYXhTY3JvbGwiLCJzY3JvbGxXaWR0aCIsImNsaWVudFdpZHRoIiwicGVyY2VudCIsIk1hdGgiLCJtaW4iLCJtYXgiLCJ0byIsIndpZHRoIiwiZHVyYXRpb24iLCJlYXNlIiwic25hcFRvTmVhcmVzdEl0ZW0iLCJuZWFyZXN0SW5kZXgiLCJtaW5EaXN0YW5jZSIsIkluZmluaXR5IiwiaXRlbSIsImluZGV4IiwiZGlzdGFuY2UiLCJhYnMiLCJvZmZzZXRMZWZ0IiwicGFkZGluZ0xlZnQiLCJwYXJzZUZsb2F0IiwiZ2V0Q29tcHV0ZWRTdHlsZSIsInRhcmdldFNjcm9sbExlZnQiLCJvblVwZGF0ZSIsIm9uQ29tcGxldGUiLCJpbmVydGlhTG9vcCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsInN0YXJ0RHJhZyIsImUiLCJidXR0b24iLCJjbGFzc0xpc3QiLCJhZGQiLCJpbmNsdWRlcyIsInBhZ2VYIiwidG91Y2hlcyIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwib25EcmFnIiwieCIsImRlbHRhIiwid2luZG93IiwiaW5uZXJXaWR0aCIsImVuZERyYWciLCJyZW1vdmUiLCJhZGRFdmVudExpc3RlbmVyIiwicGFzc2l2ZSIsInJvdGF0aW9uSW50ZW5zaXR5IiwicmVzZXRSb3RhdGlvbiIsInJvdGF0aW9uWiIsIm92ZXJ3cml0ZSIsInVwZGF0ZUl0ZW1Sb3RhdGlvbnMiLCJ2IiwiZmFjdG9yIiwicm90YXRlWiIsInV0aWxzIiwiY2xhbXAiLCJkZXRhaWwiXSwic291cmNlUm9vdCI6IiJ9