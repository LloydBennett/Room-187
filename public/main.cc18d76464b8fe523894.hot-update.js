"use strict";
self["webpackHotUpdateroom187"]("main",{

/***/ "./app/pages/Home/index.js":
/*!*********************************!*\
  !*** ./app/pages/Home/index.js ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ Home)
/* harmony export */ });
/* harmony import */ var classes_Page__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! classes/Page */ "./app/classes/Page.js");
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gsap */ "./node_modules/gsap/index.js");
/* harmony import */ var gsap_ScrollTrigger__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gsap/ScrollTrigger */ "./node_modules/gsap/ScrollTrigger.js");



class Home extends classes_Page__WEBPACK_IMPORTED_MODULE_0__["default"] {
  constructor() {
    super({
      id: 'home',
      elements: {
        heroContent: '[data-hero-content]',
        homeBody: '[data-home-body]',
        videoBlock: '[data-video-scroll]',
        video: '[data-video-scroll] [data-video]',
        polaroid: '[data-polaroid]',
        roomKeySection: '[data-room-key-section]',
        roomKeyHeader: '[data-room-key-header]',
        roomKeyTitle: '[data-room-key-titles]',
        roomKey: '[data-room-key]',
        progressBar: '[data-progress-bar]',
        progressHighlight: '[data-progress-highlight]',
        progressIndices: '[data-progress-index]',
        steps: '[data-progress-steps]',
        artistNames: '[data-artist-name-animation]',
        stepContainer: '[data-step-container]'
      }
    });
    gsap__WEBPACK_IMPORTED_MODULE_1__["default"].registerPlugin(gsap_ScrollTrigger__WEBPACK_IMPORTED_MODULE_2__.ScrollTrigger);
    this.mm = gsap__WEBPACK_IMPORTED_MODULE_1__["default"].matchMedia();
    this.pinnedHeight = this.elements.roomKeySection ? this.elements.roomKeySection.offsetHeight : 100;
    this.isProgressBarVisible = false;
    this.currentActiveIndex = -1;
    this.init();
  }
  init() {
    this.setUpScrollAnimations();
  }
  animateIndexHighlighter(newIndex) {
    if (newIndex !== this.currentActiveIndex) {
      let yPosCalc = newIndex * 100;
      let yPos = `${yPosCalc}%`;
      gsap__WEBPACK_IMPORTED_MODULE_1__["default"].to(this.elements.progressHighlight, {
        y: yPos,
        duration: 0.4,
        ease: "power2.out"
      });
      this.currentActiveIndex = newIndex;
    }
  }
  hideProgressBar() {
    gsap__WEBPACK_IMPORTED_MODULE_1__["default"].to(this.elements.progressBar, {
      opacity: 0,
      duration: 0.4,
      ease: "power2.out"
    });
    this.isProgressBarVisible = false;
  }
  showProgressBar() {
    gsap__WEBPACK_IMPORTED_MODULE_1__["default"].to(this.elements.progressBar, {
      opacity: 1,
      duration: 0.4,
      ease: "power2.out"
    });
    this.isProgressBarVisible = true;
  }
  setUpScrollAnimations() {
    this.polaroidParallax();
    this.roomKeyAnimations();
    this.artistSectionAnimations();
  }
  polaroidParallax() {
    if (!this.elements.polaroid) return;
    this.elements.polaroid.forEach((element, i) => {
      gsap__WEBPACK_IMPORTED_MODULE_1__["default"].fromTo(element, {
        opacity: 0
      }, {
        opacity: 1,
        scrollTrigger: {
          trigger: element,
          start: '50% bottom',
          scrub: false,
          markers: false
        },
        ease: "power2.out",
        duration: 0.6
      });
      gsap__WEBPACK_IMPORTED_MODULE_1__["default"].fromTo(element, {
        y: "10%"
      }, {
        y: "-20%",
        scrollTrigger: {
          trigger: element,
          start: '5% bottom',
          scrub: true,
          markers: false
        },
        ease: "power2.out"
      });
    });
  }
  roomKeyAnimations() {
    if (!this.elements.roomKey || !this.elements.steps || !this.elements.roomKeyHeader || !this.elements.stepContainer || !this.elements.progressBar) return;
    let totalStepsHeight = this.elements.steps ? Array.from(this.elements.steps).reduce((total, step) => total + step.offsetHeight, 0) : null;
    let adjustedPinDuration = totalStepsHeight - (this.elements.roomKey.offsetHeight + this.elements.roomKey.offsetHeight / 4);
    let scrollOptions = {
      trigger: this.elements.roomKey,
      start: "center center",
      end: `+=${this.elements.steps[0].offsetHeight}`,
      scrub: true,
      onEnter: () => gsap__WEBPACK_IMPORTED_MODULE_1__["default"].set(this.elements.steps, {
        opacity: 0
      })
    };
    gsap__WEBPACK_IMPORTED_MODULE_1__["default"].set(this.elements.steps, {
      opacity: 0,
      y: 50
    });
    gsap__WEBPACK_IMPORTED_MODULE_1__["default"].set(this.elements.progressBar, {
      opacity: 0
    });
    this.mm.add("(max-width: 767px)", () => {
      const roomKeyPinStart = "center 30%";
      const roomKeyPinEnd = adjustedPinDuration + this.elements.steps.length * window.innerHeight;
      gsap_ScrollTrigger__WEBPACK_IMPORTED_MODULE_2__.ScrollTrigger.create({
        id: "roomKeyPin",
        trigger: this.elements.roomKeyHeader,
        start: "top top",
        end: () => {
          const headerRect = this.elements.roomKeyHeader.getBoundingClientRect();
          const roomKeyRect = this.elements.roomKey.getBoundingClientRect();
          const distance = roomKeyRect.top - headerRect.top + this.elements.roomKey.offsetHeight;
          console.log(distance);
          return `+=${distance}`;
        },
        pin: true,
        pinSpacing: false,
        scrub: true
      });
      gsap__WEBPACK_IMPORTED_MODULE_1__["default"].to(this.elements.roomKeyHeader, {
        opacity: 0,
        scrollTrigger: {
          trigger: this.elements.roomKey,
          start: "top 70%",
          end: "top 30%",
          scrub: true
        }
      });

      // master pin
      gsap_ScrollTrigger__WEBPACK_IMPORTED_MODULE_2__.ScrollTrigger.create({
        trigger: this.elements.roomKey,
        start: roomKeyPinStart,
        end: `+=${roomKeyPinEnd}`,
        pin: this.elements.roomKeySection,
        pinSpacing: true,
        anticipatePin: 0.5,
        scrub: true
      });
      gsap_ScrollTrigger__WEBPACK_IMPORTED_MODULE_2__.ScrollTrigger.create({
        trigger: this.elements.stepContainer,
        start: "bottom bottom",
        end: `+=${roomKeyPinEnd}`,
        scrub: true
      });
      gsap__WEBPACK_IMPORTED_MODULE_1__["default"].set(this.elements.steps, {
        opacity: 0,
        position: "absolute",
        width: "100%"
      });
      let stepTl = gsap__WEBPACK_IMPORTED_MODULE_1__["default"].timeline({
        scrollTrigger: {
          trigger: this.elements.stepContainer,
          start: "bottom bottom",
          end: `+=${roomKeyPinEnd}`,
          scrub: true,
          onUpdate: self => {
            let totalSteps = this.elements.steps.length;
            let rawIndex = Math.floor(self.progress * totalSteps); // 0..totalSteps-1

            // Clamp to valid index
            let activeIndex = Math.min(Math.max(rawIndex, 1), totalSteps - 1);
            this.animateIndexHighlighter(activeIndex - 1);
            if (activeIndex === 2) {
              this.elements.roomKey.classList.add("flip");
            }
            if (activeIndex < 2) {
              this.elements.roomKey.classList.remove("flip");
            }
          }
        }
      });
      this.elements.steps.forEach((step, index) => {
        stepTl.to(step, {
          opacity: 1,
          duration: 0.8
        });
        if (index < this.elements.steps.length - 1) {
          stepTl.to(step, {
            opacity: 0,
            duration: 0.8
          }, "+=1.5");
        }
      });
      gsap_ScrollTrigger__WEBPACK_IMPORTED_MODULE_2__.ScrollTrigger.create({
        trigger: this.elements.steps[1],
        start: "top 60%",
        end: "top 40%",
        onEnter: () => this.showProgressBar(),
        onLeaveBack: () => this.hideProgressBar(),
        scrub: true,
        pinSpacing: false
      });
      window.addEventListener("resize", () => gsap_ScrollTrigger__WEBPACK_IMPORTED_MODULE_2__.ScrollTrigger.refresh());
    });
    this.mm.add("(min-width: 768px)", () => {
      gsap_ScrollTrigger__WEBPACK_IMPORTED_MODULE_2__.ScrollTrigger.create({
        id: "roomKeyPin",
        trigger: this.elements.roomKeyHeader,
        start: "top top",
        end: () => `+=${this.elements.roomKey.offsetHeight * 1.5}`,
        // Keep it pinned while roomKey moves over
        pin: true,
        pinSpacing: false,
        scrub: true
      });
      gsap__WEBPACK_IMPORTED_MODULE_1__["default"].to(this.elements.roomKeyHeader, {
        opacity: 0,
        scrollTrigger: {
          trigger: this.elements.roomKey,
          start: "top 55%",
          end: "top 30%",
          scrub: true
        }
      });
      gsap_ScrollTrigger__WEBPACK_IMPORTED_MODULE_2__.ScrollTrigger.create({
        trigger: this.elements.roomKey,
        start: "center center",
        end: `+=${adjustedPinDuration}`,
        pin: true,
        scrub: true
      });
      gsap__WEBPACK_IMPORTED_MODULE_1__["default"].to(this.elements.roomKey, {
        x: "85%",
        rotate: "5deg",
        ease: "power2.out",
        scrollTrigger: scrollOptions
      });

      // Step opacity should be scroll-based (fade in/out based on scroll)
      this.elements.steps.forEach((step, index) => {
        gsap_ScrollTrigger__WEBPACK_IMPORTED_MODULE_2__.ScrollTrigger.create({
          trigger: step,
          start: "top 70%",
          end: "top 50%",
          scrub: true,
          toggleActions: "play none none reverse",
          onEnter: () => gsap__WEBPACK_IMPORTED_MODULE_1__["default"].to(step, {
            opacity: 1,
            y: 0,
            duration: 0.3
          }),
          onLeaveBack: () => gsap__WEBPACK_IMPORTED_MODULE_1__["default"].to(step, {
            opacity: 0,
            y: 50,
            duration: 0.3
          })
        });

        // **Flip room-key when the second step appears**
        if (index === 2) {
          gsap_ScrollTrigger__WEBPACK_IMPORTED_MODULE_2__.ScrollTrigger.create({
            trigger: step,
            start: "top center",
            onEnter: () => this.elements.roomKey.classList.add("flip"),
            onLeaveBack: () => this.elements.roomKey.classList.remove("flip")
          });
        }
        gsap_ScrollTrigger__WEBPACK_IMPORTED_MODULE_2__.ScrollTrigger.create({
          trigger: step,
          start: "top 50%",
          // When the step reaches 50% of the viewport
          end: "top 30%",
          // When the step is almost fully in view
          onEnter: () => {
            if (index === 0) {
              this.animateIndexHighlighter(index); // Highlight the corresponding dot for the current step
            } else {
              this.animateIndexHighlighter(index - 1); // Highlight the corresponding dot for the current step
            }
          },
          onLeaveBack: () => {
            if (index === 1) {
              this.animateIndexHighlighter(index - 1);
            } else {
              this.animateIndexHighlighter(index - 2);
            }
          }
        });
      });
    });

    // Pin progress bar at all times (only show/hide)
    gsap_ScrollTrigger__WEBPACK_IMPORTED_MODULE_2__.ScrollTrigger.create({
      trigger: this.elements.roomKeySection,
      start: "top top",
      end: "bottom bottom",
      pin: this.elements.progressBar
    });

    // Show progress bar when roomKey is fully in view

    gsap_ScrollTrigger__WEBPACK_IMPORTED_MODULE_2__.ScrollTrigger.create({
      trigger: this.elements.steps[1],
      start: "top center",
      // When the first step reaches the center of the viewport
      onEnter: () => this.showProgressBar(),
      onLeaveBack: () => this.hideProgressBar(),
      markers: false
    });
    window.addEventListener("resize", () => gsap_ScrollTrigger__WEBPACK_IMPORTED_MODULE_2__.ScrollTrigger.refresh());
  }
  artistSectionAnimations() {
    if (!this.elements.videoBlock || !this.elements.video || !this.elements.artistNames) return;
    gsap__WEBPACK_IMPORTED_MODULE_1__["default"].fromTo(this.elements.videoBlock, {
      clipPath: "polygon(5% 5%, 95% 5%, 95% 95%, 5% 95%)"
    }, {
      clipPath: "polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)",
      scrollTrigger: {
        trigger: this.elements.videoBlock,
        start: '5% bottom',
        scrub: true,
        markers: false
      },
      ease: "power2.out"
    });
    gsap__WEBPACK_IMPORTED_MODULE_1__["default"].fromTo(this.elements.video, {
      scale: 1.5
    }, {
      scale: 1,
      scrollTrigger: {
        trigger: this.elements.videoBlock,
        start: '5% bottom',
        // Start the animation when the top of the heroContent hits 90% of the viewport
        scrub: true,
        markers: false
      },
      ease: "power2.out"
    });
    this.elements.artistNames.forEach((name, i) => {
      let getVal = name.getAttribute('data-artist-name-animation');
      let startXpos = getVal === "left" ? "10%" : "-10%";
      gsap__WEBPACK_IMPORTED_MODULE_1__["default"].fromTo(name, {
        x: startXpos,
        opacity: 0
      }, {
        x: 0,
        opacity: 1,
        ease: "power2.out",
        duration: 0.4,
        scrollTrigger: {
          trigger: name,
          start: "top bottom",
          markers: false,
          scrub: true
        }
      });
    });
  }
}

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("0daea31c0365023a42ae")
/******/ })();
/******/ 
/******/ }
);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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d2VicGFjazovL3Jvb20xODcvLi9hcHAvcGFnZXMvSG9tZS9pbmRleC5qcyIsIndlYnBhY2s6Ly9yb29tMTg3L3dlYnBhY2svcnVudGltZS9nZXRGdWxsSGFzaCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUGFnZSBmcm9tICdjbGFzc2VzL1BhZ2UnXG5pbXBvcnQgZ3NhcCBmcm9tICdnc2FwJ1xuaW1wb3J0IHsgU2Nyb2xsVHJpZ2dlciB9IGZyb20gJ2dzYXAvU2Nyb2xsVHJpZ2dlcidcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSG9tZSBleHRlbmRzIFBhZ2Uge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcih7XG4gICAgICBpZDogJ2hvbWUnLFxuICAgICAgZWxlbWVudHM6IHtcbiAgICAgICAgaGVyb0NvbnRlbnQ6ICdbZGF0YS1oZXJvLWNvbnRlbnRdJyxcbiAgICAgICAgaG9tZUJvZHk6ICdbZGF0YS1ob21lLWJvZHldJyxcbiAgICAgICAgdmlkZW9CbG9jazogJ1tkYXRhLXZpZGVvLXNjcm9sbF0nLFxuICAgICAgICB2aWRlbzogJ1tkYXRhLXZpZGVvLXNjcm9sbF0gW2RhdGEtdmlkZW9dJyxcbiAgICAgICAgcG9sYXJvaWQ6ICdbZGF0YS1wb2xhcm9pZF0nLFxuICAgICAgICByb29tS2V5U2VjdGlvbjogJ1tkYXRhLXJvb20ta2V5LXNlY3Rpb25dJyxcbiAgICAgICAgcm9vbUtleUhlYWRlcjogJ1tkYXRhLXJvb20ta2V5LWhlYWRlcl0nLFxuICAgICAgICByb29tS2V5VGl0bGU6ICdbZGF0YS1yb29tLWtleS10aXRsZXNdJyxcbiAgICAgICAgcm9vbUtleTogJ1tkYXRhLXJvb20ta2V5XScsXG4gICAgICAgIHByb2dyZXNzQmFyOiAnW2RhdGEtcHJvZ3Jlc3MtYmFyXScsXG4gICAgICAgIHByb2dyZXNzSGlnaGxpZ2h0OiAnW2RhdGEtcHJvZ3Jlc3MtaGlnaGxpZ2h0XScsXG4gICAgICAgIHByb2dyZXNzSW5kaWNlczogJ1tkYXRhLXByb2dyZXNzLWluZGV4XScsXG4gICAgICAgIHN0ZXBzOiAnW2RhdGEtcHJvZ3Jlc3Mtc3RlcHNdJyxcbiAgICAgICAgYXJ0aXN0TmFtZXM6ICdbZGF0YS1hcnRpc3QtbmFtZS1hbmltYXRpb25dJyxcbiAgICAgICAgc3RlcENvbnRhaW5lcjogJ1tkYXRhLXN0ZXAtY29udGFpbmVyXSdcbiAgICAgIH1cbiAgICB9KVxuICAgIFxuICAgIGdzYXAucmVnaXN0ZXJQbHVnaW4oU2Nyb2xsVHJpZ2dlcilcbiAgICBcbiAgICB0aGlzLm1tID0gZ3NhcC5tYXRjaE1lZGlhKClcbiAgICB0aGlzLnBpbm5lZEhlaWdodCA9IHRoaXMuZWxlbWVudHMucm9vbUtleVNlY3Rpb24/IHRoaXMuZWxlbWVudHMucm9vbUtleVNlY3Rpb24ub2Zmc2V0SGVpZ2h0IDogMTAwXG4gICAgdGhpcy5pc1Byb2dyZXNzQmFyVmlzaWJsZSA9IGZhbHNlXG4gICAgdGhpcy5jdXJyZW50QWN0aXZlSW5kZXggPSAtMVxuXG4gICAgdGhpcy5pbml0KClcbiAgfVxuXG4gIGluaXQoKSB7XG4gICAgdGhpcy5zZXRVcFNjcm9sbEFuaW1hdGlvbnMoKVxuICB9XG5cbiAgYW5pbWF0ZUluZGV4SGlnaGxpZ2h0ZXIobmV3SW5kZXgpIHtcbiAgICBpZihuZXdJbmRleCAhPT0gdGhpcy5jdXJyZW50QWN0aXZlSW5kZXgpIHtcbiAgICAgIGxldCB5UG9zQ2FsYyA9IG5ld0luZGV4ICogMTAwXG4gICAgICBsZXQgeVBvcyA9IGAke3lQb3NDYWxjfSVgXG5cbiAgICAgIGdzYXAudG8odGhpcy5lbGVtZW50cy5wcm9ncmVzc0hpZ2hsaWdodCwgeyB5OiB5UG9zLCBkdXJhdGlvbjogMC40LCBlYXNlOiBcInBvd2VyMi5vdXRcIiB9KVxuICAgICAgdGhpcy5jdXJyZW50QWN0aXZlSW5kZXggPSBuZXdJbmRleFxuICAgIH1cbiAgfVxuXG4gIGhpZGVQcm9ncmVzc0JhcigpIHtcbiAgICBnc2FwLnRvKHRoaXMuZWxlbWVudHMucHJvZ3Jlc3NCYXIgLCB7XG4gICAgICBvcGFjaXR5OiAwLFxuICAgICAgZHVyYXRpb246IDAuNCxcbiAgICAgIGVhc2U6IFwicG93ZXIyLm91dFwiXG4gICAgfSlcblxuICAgIHRoaXMuaXNQcm9ncmVzc0JhclZpc2libGUgPSBmYWxzZVxuICB9XG5cbiAgc2hvd1Byb2dyZXNzQmFyKCkge1xuICAgIGdzYXAudG8odGhpcy5lbGVtZW50cy5wcm9ncmVzc0JhciAsIHtcbiAgICAgIG9wYWNpdHk6IDEsXG4gICAgICBkdXJhdGlvbjogMC40LFxuICAgICAgZWFzZTogXCJwb3dlcjIub3V0XCJcbiAgICB9KVxuXG4gICAgdGhpcy5pc1Byb2dyZXNzQmFyVmlzaWJsZSA9IHRydWVcbiAgfVxuXG4gIHNldFVwU2Nyb2xsQW5pbWF0aW9ucygpIHtcbiAgICB0aGlzLnBvbGFyb2lkUGFyYWxsYXgoKVxuICAgIHRoaXMucm9vbUtleUFuaW1hdGlvbnMoKVxuICAgIHRoaXMuYXJ0aXN0U2VjdGlvbkFuaW1hdGlvbnMoKVxuICB9XG4gIFxuICBwb2xhcm9pZFBhcmFsbGF4KCkge1xuICAgIGlmKCF0aGlzLmVsZW1lbnRzLnBvbGFyb2lkKSByZXR1cm5cblxuICAgIHRoaXMuZWxlbWVudHMucG9sYXJvaWQuZm9yRWFjaCgoZWxlbWVudCwgaSkgPT4ge1xuICAgICAgZ3NhcC5mcm9tVG8oZWxlbWVudCwgXG4gICAgICAgIHtcbiAgICAgICAgICBvcGFjaXR5OiAwXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgIHNjcm9sbFRyaWdnZXI6IHtcbiAgICAgICAgICAgIHRyaWdnZXI6IGVsZW1lbnQsXG4gICAgICAgICAgICBzdGFydDogJzUwJSBib3R0b20nLFxuICAgICAgICAgICAgc2NydWI6IGZhbHNlLFxuICAgICAgICAgICAgbWFya2VyczogZmFsc2VcbiAgICAgICAgICB9LFxuICAgICAgICAgIGVhc2U6IFwicG93ZXIyLm91dFwiLFxuICAgICAgICAgIGR1cmF0aW9uOiAwLjZcbiAgICAgICAgfVxuICAgICAgKVxuXG4gICAgICBnc2FwLmZyb21UbyhlbGVtZW50LCBcbiAgICAgICAge1xuICAgICAgICAgIHk6IFwiMTAlXCJcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIHk6IFwiLTIwJVwiLFxuICAgICAgICAgIHNjcm9sbFRyaWdnZXI6IHtcbiAgICAgICAgICAgIHRyaWdnZXI6IGVsZW1lbnQsXG4gICAgICAgICAgICBzdGFydDogJzUlIGJvdHRvbScsXG4gICAgICAgICAgICBzY3J1YjogdHJ1ZSxcbiAgICAgICAgICAgIG1hcmtlcnM6IGZhbHNlLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgZWFzZTogXCJwb3dlcjIub3V0XCIsXG4gICAgICAgIH1cbiAgICAgIClcbiAgICB9KVxuICB9XG4gIFxuICByb29tS2V5QW5pbWF0aW9ucygpIHtcbiAgICBpZiAoIXRoaXMuZWxlbWVudHMucm9vbUtleSB8fCAhdGhpcy5lbGVtZW50cy5zdGVwcyB8fCAhdGhpcy5lbGVtZW50cy5yb29tS2V5SGVhZGVyIHx8ICF0aGlzLmVsZW1lbnRzLnN0ZXBDb250YWluZXIgfHwgIXRoaXMuZWxlbWVudHMucHJvZ3Jlc3NCYXIpIHJldHVybjtcblxuICAgIGxldCB0b3RhbFN0ZXBzSGVpZ2h0ID0gdGhpcy5lbGVtZW50cy5zdGVwcz8gQXJyYXkuZnJvbSh0aGlzLmVsZW1lbnRzLnN0ZXBzKS5yZWR1Y2UoKHRvdGFsLCBzdGVwKSA9PiB0b3RhbCArIHN0ZXAub2Zmc2V0SGVpZ2h0LCAwKSA6IG51bGw7XG4gICAgbGV0IGFkanVzdGVkUGluRHVyYXRpb24gPSB0b3RhbFN0ZXBzSGVpZ2h0IC0gKHRoaXMuZWxlbWVudHMucm9vbUtleS5vZmZzZXRIZWlnaHQgKyAodGhpcy5lbGVtZW50cy5yb29tS2V5Lm9mZnNldEhlaWdodCAvIDQpKTtcbiAgICBsZXQgc2Nyb2xsT3B0aW9ucyA9IHtcbiAgICAgIHRyaWdnZXI6IHRoaXMuZWxlbWVudHMucm9vbUtleSxcbiAgICAgIHN0YXJ0OiBcImNlbnRlciBjZW50ZXJcIixcbiAgICAgIGVuZDogYCs9JHt0aGlzLmVsZW1lbnRzLnN0ZXBzWzBdLm9mZnNldEhlaWdodH1gLFxuICAgICAgc2NydWI6IHRydWUsXG4gICAgICBvbkVudGVyOiAoKSA9PiBnc2FwLnNldCh0aGlzLmVsZW1lbnRzLnN0ZXBzLCB7IG9wYWNpdHk6IDAgfSlcbiAgICB9XG5cbiAgICBnc2FwLnNldCh0aGlzLmVsZW1lbnRzLnN0ZXBzLCB7IG9wYWNpdHk6IDAsIHk6IDUwIH0pXG4gICAgZ3NhcC5zZXQodGhpcy5lbGVtZW50cy5wcm9ncmVzc0JhciwgeyBvcGFjaXR5OiAwIH0pXG5cbiAgICB0aGlzLm1tLmFkZChcIihtYXgtd2lkdGg6IDc2N3B4KVwiLCAoKSA9PiB7XG4gICAgICBjb25zdCByb29tS2V5UGluU3RhcnQgPSBcImNlbnRlciAzMCVcIjtcbiAgICAgIGNvbnN0IHJvb21LZXlQaW5FbmQgPSBhZGp1c3RlZFBpbkR1cmF0aW9uICsgdGhpcy5lbGVtZW50cy5zdGVwcy5sZW5ndGggKiB3aW5kb3cuaW5uZXJIZWlnaHQ7XG4gICAgICBcbiAgICAgIFNjcm9sbFRyaWdnZXIuY3JlYXRlKHtcbiAgICAgICAgaWQ6IFwicm9vbUtleVBpblwiLFxuICAgICAgICB0cmlnZ2VyOiB0aGlzLmVsZW1lbnRzLnJvb21LZXlIZWFkZXIsXG4gICAgICAgIHN0YXJ0OiBcInRvcCB0b3BcIixcbiAgICAgICAgZW5kOiAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgaGVhZGVyUmVjdCA9IHRoaXMuZWxlbWVudHMucm9vbUtleUhlYWRlci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICBjb25zdCByb29tS2V5UmVjdCA9IHRoaXMuZWxlbWVudHMucm9vbUtleS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICBjb25zdCBkaXN0YW5jZSA9IChyb29tS2V5UmVjdC50b3AgLSBoZWFkZXJSZWN0LnRvcCkgKyB0aGlzLmVsZW1lbnRzLnJvb21LZXkub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgIGNvbnNvbGUubG9nKGRpc3RhbmNlKVxuICAgICAgICAgIHJldHVybiBgKz0ke2Rpc3RhbmNlfWA7XG4gICAgICAgIH0sXG4gICAgICAgIHBpbjogdHJ1ZSxcbiAgICAgICAgcGluU3BhY2luZzogZmFsc2UsXG4gICAgICAgIHNjcnViOiB0cnVlXG4gICAgICB9KTtcblxuICAgICAgZ3NhcC50byh0aGlzLmVsZW1lbnRzLnJvb21LZXlIZWFkZXIsIHtcbiAgICAgICAgb3BhY2l0eTogMCxcbiAgICAgICAgc2Nyb2xsVHJpZ2dlcjoge1xuICAgICAgICAgIHRyaWdnZXI6IHRoaXMuZWxlbWVudHMucm9vbUtleSxcbiAgICAgICAgICBzdGFydDogXCJ0b3AgNzAlXCIsXG4gICAgICAgICAgZW5kOiBcInRvcCAzMCVcIixcbiAgICAgICAgICBzY3J1YjogdHJ1ZVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICAvLyBtYXN0ZXIgcGluXG4gICAgICBTY3JvbGxUcmlnZ2VyLmNyZWF0ZSh7XG4gICAgICAgIHRyaWdnZXI6IHRoaXMuZWxlbWVudHMucm9vbUtleSxcbiAgICAgICAgc3RhcnQ6IHJvb21LZXlQaW5TdGFydCxcbiAgICAgICAgZW5kOiBgKz0ke3Jvb21LZXlQaW5FbmR9YCxcbiAgICAgICAgcGluOiB0aGlzLmVsZW1lbnRzLnJvb21LZXlTZWN0aW9uLFxuICAgICAgICBwaW5TcGFjaW5nOiB0cnVlLFxuICAgICAgICBhbnRpY2lwYXRlUGluOiAwLjUsXG4gICAgICAgIHNjcnViOiB0cnVlXG4gICAgICB9KTtcblxuICAgICAgU2Nyb2xsVHJpZ2dlci5jcmVhdGUoe1xuICAgICAgICB0cmlnZ2VyOiB0aGlzLmVsZW1lbnRzLnN0ZXBDb250YWluZXIsXG4gICAgICAgIHN0YXJ0OiBcImJvdHRvbSBib3R0b21cIixcbiAgICAgICAgZW5kOiBgKz0ke3Jvb21LZXlQaW5FbmR9YCxcbiAgICAgICAgc2NydWI6IHRydWVcbiAgICAgIH0pO1xuXG4gICAgICBnc2FwLnNldCh0aGlzLmVsZW1lbnRzLnN0ZXBzLCB7IG9wYWNpdHk6IDAsIHBvc2l0aW9uOiBcImFic29sdXRlXCIsIHdpZHRoOiBcIjEwMCVcIiB9KTtcblxuICAgICAgbGV0IHN0ZXBUbCA9IGdzYXAudGltZWxpbmUoe1xuICAgICAgICBzY3JvbGxUcmlnZ2VyOiB7XG4gICAgICAgICAgdHJpZ2dlcjogdGhpcy5lbGVtZW50cy5zdGVwQ29udGFpbmVyLFxuICAgICAgICAgIHN0YXJ0OiBcImJvdHRvbSBib3R0b21cIixcbiAgICAgICAgICBlbmQ6IGArPSR7cm9vbUtleVBpbkVuZH1gLFxuICAgICAgICAgIHNjcnViOiB0cnVlLFxuICAgICAgICAgIG9uVXBkYXRlOiBzZWxmID0+IHtcbiAgICAgICAgICAgIGxldCB0b3RhbFN0ZXBzID0gdGhpcy5lbGVtZW50cy5zdGVwcy5sZW5ndGg7XG4gICAgICAgICAgICBsZXQgcmF3SW5kZXggPSBNYXRoLmZsb29yKHNlbGYucHJvZ3Jlc3MgKiB0b3RhbFN0ZXBzKTsgLy8gMC4udG90YWxTdGVwcy0xXG5cbiAgICAgICAgICAgIC8vIENsYW1wIHRvIHZhbGlkIGluZGV4XG4gICAgICAgICAgICBsZXQgYWN0aXZlSW5kZXggPSBNYXRoLm1pbihNYXRoLm1heChyYXdJbmRleCwgMSksIHRvdGFsU3RlcHMgLSAxKTtcblxuICAgICAgICAgICAgdGhpcy5hbmltYXRlSW5kZXhIaWdobGlnaHRlcihhY3RpdmVJbmRleCAtIDEpO1xuXG4gICAgICAgICAgICBpZiAoYWN0aXZlSW5kZXggPT09IDIpIHtcbiAgICAgICAgICAgICAgdGhpcy5lbGVtZW50cy5yb29tS2V5LmNsYXNzTGlzdC5hZGQoXCJmbGlwXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFjdGl2ZUluZGV4IDwgMikge1xuICAgICAgICAgICAgICB0aGlzLmVsZW1lbnRzLnJvb21LZXkuY2xhc3NMaXN0LnJlbW92ZShcImZsaXBcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5lbGVtZW50cy5zdGVwcy5mb3JFYWNoKChzdGVwLCBpbmRleCkgPT4ge1xuICAgICAgICBzdGVwVGwudG8oc3RlcCwgeyBvcGFjaXR5OiAxLCBkdXJhdGlvbjogMC44IH0pXG5cbiAgICAgICAgaWYgKGluZGV4IDwgdGhpcy5lbGVtZW50cy5zdGVwcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgc3RlcFRsLnRvKHN0ZXAsIHsgb3BhY2l0eTogMCwgZHVyYXRpb246IDAuOCB9LCBcIis9MS41XCIpO1xuICAgICAgICB9XG4gICAgICAgICAgXG4gICAgICB9KTtcblxuICAgICAgU2Nyb2xsVHJpZ2dlci5jcmVhdGUoe1xuICAgICAgICB0cmlnZ2VyOiB0aGlzLmVsZW1lbnRzLnN0ZXBzWzFdLFxuICAgICAgICBzdGFydDogXCJ0b3AgNjAlXCIsXG4gICAgICAgIGVuZDogXCJ0b3AgNDAlXCIsXG4gICAgICAgIG9uRW50ZXI6ICgpID0+IHRoaXMuc2hvd1Byb2dyZXNzQmFyKCksXG4gICAgICAgIG9uTGVhdmVCYWNrOiAoKSA9PiB0aGlzLmhpZGVQcm9ncmVzc0JhcigpLFxuICAgICAgICBzY3J1YjogdHJ1ZSxcbiAgICAgICAgcGluU3BhY2luZzogZmFsc2VcbiAgICAgIH0pO1xuXG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCAoKSA9PiBTY3JvbGxUcmlnZ2VyLnJlZnJlc2goKSk7XG4gICAgfSk7XG4gICAgXG4gICAgXG4gICAgdGhpcy5tbS5hZGQoXCIobWluLXdpZHRoOiA3NjhweClcIiwgKCkgPT4ge1xuICAgICAgU2Nyb2xsVHJpZ2dlci5jcmVhdGUoe1xuICAgICAgICBpZDogXCJyb29tS2V5UGluXCIsXG4gICAgICAgIHRyaWdnZXI6IHRoaXMuZWxlbWVudHMucm9vbUtleUhlYWRlcixcbiAgICAgICAgc3RhcnQ6IFwidG9wIHRvcFwiLFxuICAgICAgICBlbmQ6ICgpID0+IGArPSR7dGhpcy5lbGVtZW50cy5yb29tS2V5Lm9mZnNldEhlaWdodCAqIDEuNX1gLCAvLyBLZWVwIGl0IHBpbm5lZCB3aGlsZSByb29tS2V5IG1vdmVzIG92ZXJcbiAgICAgICAgcGluOiB0cnVlLFxuICAgICAgICBwaW5TcGFjaW5nOiBmYWxzZSxcbiAgICAgICAgc2NydWI6IHRydWVcbiAgICAgIH0pO1xuXG4gICAgICBnc2FwLnRvKHRoaXMuZWxlbWVudHMucm9vbUtleUhlYWRlciwge1xuICAgICAgICBvcGFjaXR5OiAwLFxuICAgICAgICBzY3JvbGxUcmlnZ2VyOiB7XG4gICAgICAgICAgdHJpZ2dlcjogdGhpcy5lbGVtZW50cy5yb29tS2V5LFxuICAgICAgICAgIHN0YXJ0OiBcInRvcCA1NSVcIixcbiAgICAgICAgICBlbmQ6IFwidG9wIDMwJVwiLFxuICAgICAgICAgIHNjcnViOiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIFNjcm9sbFRyaWdnZXIuY3JlYXRlKHtcbiAgICAgICAgdHJpZ2dlcjogdGhpcy5lbGVtZW50cy5yb29tS2V5LFxuICAgICAgICBzdGFydDogXCJjZW50ZXIgY2VudGVyXCIsXG4gICAgICAgIGVuZDogYCs9JHthZGp1c3RlZFBpbkR1cmF0aW9ufWAsXG4gICAgICAgIHBpbjogdHJ1ZSxcbiAgICAgICAgc2NydWI6IHRydWVcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBnc2FwLnRvKHRoaXMuZWxlbWVudHMucm9vbUtleSwge1xuICAgICAgICB4OiBcIjg1JVwiLFxuICAgICAgICByb3RhdGU6IFwiNWRlZ1wiLFxuICAgICAgICBlYXNlOiBcInBvd2VyMi5vdXRcIixcbiAgICAgICAgc2Nyb2xsVHJpZ2dlcjogc2Nyb2xsT3B0aW9uc1xuICAgICAgfSlcblxuICAgICAgLy8gU3RlcCBvcGFjaXR5IHNob3VsZCBiZSBzY3JvbGwtYmFzZWQgKGZhZGUgaW4vb3V0IGJhc2VkIG9uIHNjcm9sbClcbiAgICAgIHRoaXMuZWxlbWVudHMuc3RlcHMuZm9yRWFjaCgoc3RlcCwgaW5kZXgpID0+IHsgXG4gICAgICAgIFNjcm9sbFRyaWdnZXIuY3JlYXRlKHtcbiAgICAgICAgICB0cmlnZ2VyOiBzdGVwLFxuICAgICAgICAgIHN0YXJ0OiBcInRvcCA3MCVcIixcbiAgICAgICAgICBlbmQ6IFwidG9wIDUwJVwiLFxuICAgICAgICAgIHNjcnViOiB0cnVlLFxuICAgICAgICAgIHRvZ2dsZUFjdGlvbnM6IFwicGxheSBub25lIG5vbmUgcmV2ZXJzZVwiLFxuICAgICAgICAgIG9uRW50ZXI6ICgpID0+IGdzYXAudG8oc3RlcCwgeyBvcGFjaXR5OiAxLCB5OiAwLCBkdXJhdGlvbjogMC4zIH0pLFxuICAgICAgICAgIG9uTGVhdmVCYWNrOiAoKSA9PiBnc2FwLnRvKHN0ZXAsIHsgb3BhY2l0eTogMCwgeTogNTAsIGR1cmF0aW9uOiAwLjMgfSlcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gKipGbGlwIHJvb20ta2V5IHdoZW4gdGhlIHNlY29uZCBzdGVwIGFwcGVhcnMqKlxuICAgICAgICBpZiAoaW5kZXggPT09IDIpIHtcbiAgICAgICAgICBTY3JvbGxUcmlnZ2VyLmNyZWF0ZSh7XG4gICAgICAgICAgICB0cmlnZ2VyOiBzdGVwLFxuICAgICAgICAgICAgc3RhcnQ6IFwidG9wIGNlbnRlclwiLFxuICAgICAgICAgICAgb25FbnRlcjogKCkgPT4gdGhpcy5lbGVtZW50cy5yb29tS2V5LmNsYXNzTGlzdC5hZGQoXCJmbGlwXCIpLFxuICAgICAgICAgICAgb25MZWF2ZUJhY2s6ICgpID0+IHRoaXMuZWxlbWVudHMucm9vbUtleS5jbGFzc0xpc3QucmVtb3ZlKFwiZmxpcFwiKVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgU2Nyb2xsVHJpZ2dlci5jcmVhdGUoe1xuICAgICAgICAgIHRyaWdnZXI6IHN0ZXAsXG4gICAgICAgICAgc3RhcnQ6IFwidG9wIDUwJVwiLCAvLyBXaGVuIHRoZSBzdGVwIHJlYWNoZXMgNTAlIG9mIHRoZSB2aWV3cG9ydFxuICAgICAgICAgIGVuZDogXCJ0b3AgMzAlXCIsIC8vIFdoZW4gdGhlIHN0ZXAgaXMgYWxtb3N0IGZ1bGx5IGluIHZpZXdcbiAgICAgICAgICBvbkVudGVyOiAoKSA9PiB7XG4gICAgICAgICAgICBpZihpbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgICB0aGlzLmFuaW1hdGVJbmRleEhpZ2hsaWdodGVyKGluZGV4KTsgLy8gSGlnaGxpZ2h0IHRoZSBjb3JyZXNwb25kaW5nIGRvdCBmb3IgdGhlIGN1cnJlbnQgc3RlcFxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5hbmltYXRlSW5kZXhIaWdobGlnaHRlcihpbmRleCAtIDEpOyAvLyBIaWdobGlnaHQgdGhlIGNvcnJlc3BvbmRpbmcgZG90IGZvciB0aGUgY3VycmVudCBzdGVwXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBvbkxlYXZlQmFjazogKCkgPT4ge1xuICAgICAgICAgICAgaWYoaW5kZXggPT09IDEpIHtcbiAgICAgICAgICAgICAgdGhpcy5hbmltYXRlSW5kZXhIaWdobGlnaHRlcihpbmRleCAtIDEpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5hbmltYXRlSW5kZXhIaWdobGlnaHRlcihpbmRleCAtIDIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KVxuICAgIH0pXG5cbiAgICAvLyBQaW4gcHJvZ3Jlc3MgYmFyIGF0IGFsbCB0aW1lcyAob25seSBzaG93L2hpZGUpXG4gICAgU2Nyb2xsVHJpZ2dlci5jcmVhdGUoe1xuICAgICAgdHJpZ2dlcjogdGhpcy5lbGVtZW50cy5yb29tS2V5U2VjdGlvbixcbiAgICAgIHN0YXJ0OiBcInRvcCB0b3BcIixcbiAgICAgIGVuZDogXCJib3R0b20gYm90dG9tXCIsXG4gICAgICBwaW46IHRoaXMuZWxlbWVudHMucHJvZ3Jlc3NCYXJcbiAgICB9KVxuXG4gICAgLy8gU2hvdyBwcm9ncmVzcyBiYXIgd2hlbiByb29tS2V5IGlzIGZ1bGx5IGluIHZpZXdcblxuICAgIFNjcm9sbFRyaWdnZXIuY3JlYXRlKHtcbiAgICAgIHRyaWdnZXI6IHRoaXMuZWxlbWVudHMuc3RlcHNbMV0sXG4gICAgICBzdGFydDogXCJ0b3AgY2VudGVyXCIsIC8vIFdoZW4gdGhlIGZpcnN0IHN0ZXAgcmVhY2hlcyB0aGUgY2VudGVyIG9mIHRoZSB2aWV3cG9ydFxuICAgICAgb25FbnRlcjogKCkgPT4gdGhpcy5zaG93UHJvZ3Jlc3NCYXIoKSxcbiAgICAgIG9uTGVhdmVCYWNrOiAoKSA9PiB0aGlzLmhpZGVQcm9ncmVzc0JhcigpLFxuICAgICAgbWFya2VyczogZmFsc2VcbiAgICB9KTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsICgpID0+IFNjcm9sbFRyaWdnZXIucmVmcmVzaCgpKTtcblxuICB9XG5cbiAgYXJ0aXN0U2VjdGlvbkFuaW1hdGlvbnMoKSB7XG4gICAgaWYgKCF0aGlzLmVsZW1lbnRzLnZpZGVvQmxvY2sgfHwgIXRoaXMuZWxlbWVudHMudmlkZW8gfHwgIXRoaXMuZWxlbWVudHMuYXJ0aXN0TmFtZXMpIHJldHVybjtcblxuICAgIGdzYXAuZnJvbVRvKHRoaXMuZWxlbWVudHMudmlkZW9CbG9jaywgXG4gICAgICB7IGNsaXBQYXRoOiBcInBvbHlnb24oNSUgNSUsIDk1JSA1JSwgOTUlIDk1JSwgNSUgOTUlKVwifSxcbiAgICAgIHtcbiAgICAgICAgY2xpcFBhdGg6IFwicG9seWdvbigwJSAwJSwgMTAwJSAwJSwgMTAwJSAxMDAlLCAwJSAxMDAlKVwiLFxuICAgICAgICBzY3JvbGxUcmlnZ2VyOiB7XG4gICAgICAgICAgdHJpZ2dlcjogdGhpcy5lbGVtZW50cy52aWRlb0Jsb2NrLFxuICAgICAgICAgIHN0YXJ0OiAnNSUgYm90dG9tJyxcbiAgICAgICAgICBzY3J1YjogdHJ1ZSxcbiAgICAgICAgICBtYXJrZXJzOiBmYWxzZVxuICAgICAgICB9LFxuICAgICAgICBlYXNlOiBcInBvd2VyMi5vdXRcIixcbiAgICAgIH1cbiAgICApXG4gICAgZ3NhcC5mcm9tVG8odGhpcy5lbGVtZW50cy52aWRlbywgXG4gICAgICB7XG4gICAgICAgIHNjYWxlOiAxLjVcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHNjYWxlOiAxLFxuICAgICAgICBzY3JvbGxUcmlnZ2VyOiB7XG4gICAgICAgICAgdHJpZ2dlcjogdGhpcy5lbGVtZW50cy52aWRlb0Jsb2NrLFxuICAgICAgICAgIHN0YXJ0OiAnNSUgYm90dG9tJywgLy8gU3RhcnQgdGhlIGFuaW1hdGlvbiB3aGVuIHRoZSB0b3Agb2YgdGhlIGhlcm9Db250ZW50IGhpdHMgOTAlIG9mIHRoZSB2aWV3cG9ydFxuICAgICAgICAgIHNjcnViOiB0cnVlLFxuICAgICAgICAgIG1hcmtlcnM6IGZhbHNlXG4gICAgICAgIH0sXG4gICAgICAgIGVhc2U6IFwicG93ZXIyLm91dFwiLFxuICAgICAgfVxuICAgIClcblxuICAgIHRoaXMuZWxlbWVudHMuYXJ0aXN0TmFtZXMuZm9yRWFjaCgobmFtZSwgaSkgPT4ge1xuICAgICAgbGV0IGdldFZhbCA9IG5hbWUuZ2V0QXR0cmlidXRlKCdkYXRhLWFydGlzdC1uYW1lLWFuaW1hdGlvbicpXG4gICAgICBsZXQgc3RhcnRYcG9zID0gZ2V0VmFsID09PSBcImxlZnRcIiA/IFwiMTAlXCI6IFwiLTEwJVwiXG4gICAgICBcbiAgICAgIGdzYXAuZnJvbVRvKG5hbWUsXG4gICAgICAgIHsgXG4gICAgICAgICAgeDogc3RhcnRYcG9zLFxuICAgICAgICAgIG9wYWNpdHk6IDBcbiAgICAgICAgfSxcbiAgICAgICAgeyBcbiAgICAgICAgICB4OiAwLFxuICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgZWFzZTogXCJwb3dlcjIub3V0XCIsXG4gICAgICAgICAgZHVyYXRpb246IDAuNCxcbiAgICAgICAgICBzY3JvbGxUcmlnZ2VyOiB7XG4gICAgICAgICAgICB0cmlnZ2VyOiBuYW1lLFxuICAgICAgICAgICAgc3RhcnQ6IFwidG9wIGJvdHRvbVwiLFxuICAgICAgICAgICAgbWFya2VyczogZmFsc2UsXG4gICAgICAgICAgICBzY3J1YjogdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKVxuXG4gICAgfSlcbiAgfVxufSIsIl9fd2VicGFja19yZXF1aXJlX18uaCA9ICgpID0+IChcIjBkYWVhMzFjMDM2NTAyM2E0MmFlXCIpIl0sIm5hbWVzIjpbIlBhZ2UiLCJnc2FwIiwiU2Nyb2xsVHJpZ2dlciIsIkhvbWUiLCJjb25zdHJ1Y3RvciIsImlkIiwiZWxlbWVudHMiLCJoZXJvQ29udGVudCIsImhvbWVCb2R5IiwidmlkZW9CbG9jayIsInZpZGVvIiwicG9sYXJvaWQiLCJyb29tS2V5U2VjdGlvbiIsInJvb21LZXlIZWFkZXIiLCJyb29tS2V5VGl0bGUiLCJyb29tS2V5IiwicHJvZ3Jlc3NCYXIiLCJwcm9ncmVzc0hpZ2hsaWdodCIsInByb2dyZXNzSW5kaWNlcyIsInN0ZXBzIiwiYXJ0aXN0TmFtZXMiLCJzdGVwQ29udGFpbmVyIiwicmVnaXN0ZXJQbHVnaW4iLCJtbSIsIm1hdGNoTWVkaWEiLCJwaW5uZWRIZWlnaHQiLCJvZmZzZXRIZWlnaHQiLCJpc1Byb2dyZXNzQmFyVmlzaWJsZSIsImN1cnJlbnRBY3RpdmVJbmRleCIsImluaXQiLCJzZXRVcFNjcm9sbEFuaW1hdGlvbnMiLCJhbmltYXRlSW5kZXhIaWdobGlnaHRlciIsIm5ld0luZGV4IiwieVBvc0NhbGMiLCJ5UG9zIiwidG8iLCJ5IiwiZHVyYXRpb24iLCJlYXNlIiwiaGlkZVByb2dyZXNzQmFyIiwib3BhY2l0eSIsInNob3dQcm9ncmVzc0JhciIsInBvbGFyb2lkUGFyYWxsYXgiLCJyb29tS2V5QW5pbWF0aW9ucyIsImFydGlzdFNlY3Rpb25BbmltYXRpb25zIiwiZm9yRWFjaCIsImVsZW1lbnQiLCJpIiwiZnJvbVRvIiwic2Nyb2xsVHJpZ2dlciIsInRyaWdnZXIiLCJzdGFydCIsInNjcnViIiwibWFya2VycyIsInRvdGFsU3RlcHNIZWlnaHQiLCJBcnJheSIsImZyb20iLCJyZWR1Y2UiLCJ0b3RhbCIsInN0ZXAiLCJhZGp1c3RlZFBpbkR1cmF0aW9uIiwic2Nyb2xsT3B0aW9ucyIsImVuZCIsIm9uRW50ZXIiLCJzZXQiLCJhZGQiLCJyb29tS2V5UGluU3RhcnQiLCJyb29tS2V5UGluRW5kIiwibGVuZ3RoIiwid2luZG93IiwiaW5uZXJIZWlnaHQiLCJjcmVhdGUiLCJoZWFkZXJSZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0Iiwicm9vbUtleVJlY3QiLCJkaXN0YW5jZSIsInRvcCIsImNvbnNvbGUiLCJsb2ciLCJwaW4iLCJwaW5TcGFjaW5nIiwiYW50aWNpcGF0ZVBpbiIsInBvc2l0aW9uIiwid2lkdGgiLCJzdGVwVGwiLCJ0aW1lbGluZSIsIm9uVXBkYXRlIiwic2VsZiIsInRvdGFsU3RlcHMiLCJyYXdJbmRleCIsIk1hdGgiLCJmbG9vciIsInByb2dyZXNzIiwiYWN0aXZlSW5kZXgiLCJtaW4iLCJtYXgiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJpbmRleCIsIm9uTGVhdmVCYWNrIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlZnJlc2giLCJ4Iiwicm90YXRlIiwidG9nZ2xlQWN0aW9ucyIsImNsaXBQYXRoIiwic2NhbGUiLCJuYW1lIiwiZ2V0VmFsIiwiZ2V0QXR0cmlidXRlIiwic3RhcnRYcG9zIl0sInNvdXJjZVJvb3QiOiIifQ==