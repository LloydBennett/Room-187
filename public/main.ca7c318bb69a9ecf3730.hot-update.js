"use strict";
self["webpackHotUpdateroom187"]("main",{

/***/ "./app/classes/Page.js":
/*!*****************************!*\
  !*** ./app/classes/Page.js ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ Page)
/* harmony export */ });
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gsap */ "./node_modules/gsap/index.js");
/* harmony import */ var gsap_CustomEase__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gsap/CustomEase */ "./node_modules/gsap/CustomEase.js");
/* harmony import */ var utils_LenisScroll__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/LenisScroll */ "./app/utils/LenisScroll.js");
/* harmony import */ var gsap_SplitText__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! gsap/SplitText */ "./node_modules/gsap/SplitText.js");
/* harmony import */ var _utils_create__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/create */ "./app/utils/create.js");





class Page {
  constructor({
    id = 'default',
    elements = {}
  } = {}) {
    this.id = id;
    this.selectors = {
      ...elements,
      overlay: '[data-page-transition]',
      slideOne: '[data-page-transition-slide-one]',
      slideTwo: '[data-page-transition-slide-two]',
      loader: '[data-loader]',
      images: '[data-loader-image]',
      imageHero: '[data-loader-hero]',
      mainTitles: '[data-hero] [data-split-text]',
      misc: '[data-misc]',
      page: '[data-page]',
      body: 'body',
      bg: '[data-bg]',
      navBar: '[data-nav-bar]',
      altImg: '[data-alt-hero-img]'
    };
    Page.prototype.create = _utils_create__WEBPACK_IMPORTED_MODULE_1__["default"];
    gsap__WEBPACK_IMPORTED_MODULE_2__["default"].registerPlugin(gsap_CustomEase__WEBPACK_IMPORTED_MODULE_3__.CustomEase, gsap_SplitText__WEBPACK_IMPORTED_MODULE_4__.SplitText);
    gsap_CustomEase__WEBPACK_IMPORTED_MODULE_3__.CustomEase.create("zoom", "0.71, 0, 0.06, 1");
    this.lScroll = utils_LenisScroll__WEBPACK_IMPORTED_MODULE_0__.scroll;
    this.create();
  }
  show(isFirstVisit) {
    return new Promise(resolve => {
      let tl = gsap__WEBPACK_IMPORTED_MODULE_2__["default"].timeline();
      const hasHeroImg = this.hasHeroImage;
      if (!this.elements.body.classList.contains('no--scrolling')) {
        this.preventScrolling();
      }
      if (isFirstVisit) {
        this.zoomAnimation(tl, isFirstVisit);
      } else if (hasHeroImg) {
        this.zoomAnimation(tl, isFirstVisit);
      }
      this.animateAssets(tl, resolve);
    });
  }
  hide() {
    return new Promise(resolve => {
      let animOut = gsap__WEBPACK_IMPORTED_MODULE_2__["default"].timeline();
      animOut.to(this.elements.overlay, {
        clipPath: "polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)",
        duration: 0.6,
        ease: "zoom"
      });
      animOut.to(this.elements.slideTwo, {
        clipPath: "polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)",
        duration: 0.6,
        ease: "zoom"
      }).add(resolve);
    });
  }
  zoomAnimation(tl, showFullAnim) {
    if (!this.elements.images) return;
    const pageName = this.elements.page?.dataset?.page || '';
    const isErrorPage = pageName === 'error';
    const hasHeroImg = this.hasHeroImage;
    let smallHeroImg = document.querySelector('[data-image-hero="small"]');
    if (isErrorPage) {
      tl.to(this.elements.loader, {
        display: "flex",
        duration: 0.01
      });
      this.showImages(tl, false);
      tl.to({}, {
        onComplete: () => {
          this.elements.loader.classList.add('bg--error');
        }
      }, "-=0.8");
      tl.to(this.elements.loader, {
        display: "none",
        duration: 0.01,
        onComplete: () => {
          this.elements.loader.classList.remove('bg--error');
        }
      }, "+=0.6");
    } else {
      tl.to(this.elements.loader, {
        display: "flex",
        duration: 0.01
      });
      this.showImages(tl, showFullAnim);
      if (hasHeroImg) {
        if (smallHeroImg) {
          this.elements.imageHero.style.top = 0;
        }
        tl.to(this.elements.imageHero, {
          opacity: 1,
          duration: 0.04,
          ease: "linear"
        }, "+=0.15");
        tl.to(this.elements.imageHero, {
          scale: 1,
          clipPath: "polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)",
          duration: 0.6,
          ease: "zoom"
        }, "+=0.4");
        if (smallHeroImg) {
          let imgHeight = smallHeroImg.offsetHeight;
          let loaderImgs = document.querySelectorAll('[data-loader-image]:not([data-loader-hero])');
          tl.to(loaderImgs, {
            opacity: 0,
            duration: 0.01,
            ease: "linear"
          }).to(this.elements.imageHero, {
            height: imgHeight,
            duration: 0.6,
            ease: "zoom"
          });
        }
        tl.to(this.elements.loader, {
          display: "none",
          duration: 0.01,
          onComplete: () => {
            tl.to(this.elements.imageHero, {
              scale: 0.5,
              clipPath: "polygon(20% 10%, 80% 10%, 80% 90%, 20% 90%)",
              duration: 0.01
            });
            if (smallHeroImg) {
              this.elements.imageHero.style.height = '';
              this.elements.imageHero.style.top = '';
            }
          }
        });
      } else {
        tl.to(this.elements.loader, {
          display: "none",
          duration: 0.01
        }, "+=0.6");
      }
    }
    tl.to(this.elements.images, {
      opacity: 0,
      duration: 0.01,
      ease: "linear"
    });
  }
  showImages(tl, showFullAnim) {
    if (showFullAnim) {
      this.elements.images.forEach((img, i) => {
        tl.to(img, {
          opacity: 1,
          duration: 0.04,
          ease: "linear"
        }, "+=0.15");
      });
    } else {
      for (let i = 0; i < Math.min(4, this.elements.images.length); i++) {
        tl.to(this.elements.images[i], {
          opacity: 1,
          duration: 0.04,
          ease: "linear"
        }, "+=0.15");
      }
    }
  }
  animateAssets(tl, resolve) {
    gsap__WEBPACK_IMPORTED_MODULE_2__["default"].set(this.elements.overlay, {
      clipPath: "polygon(0% 100%, 100% 100%, 100% 100%, 0% 100%)"
    });
    gsap__WEBPACK_IMPORTED_MODULE_2__["default"].set(this.elements.slideTwo, {
      clipPath: "polygon(0% 100%, 100% 100%, 100% 100%, 0% 100%)"
    });
    if (!this.elements.mainTitles || this.elements.mainTitles.length === 0) {
      console.warn('mainTitles not found or empty:', this.elements.mainTitles);
    }
    document.fonts.ready.then(() => {
      const heroTitles = this.elements.mainTitles instanceof NodeList || Array.isArray(this.elements.mainTitles) ? Array.from(this.elements.mainTitles) : this.elements.mainTitles ? [this.elements.mainTitles] : [];
      const allLines = [];
      heroTitles.forEach(el => {
        const split = gsap_SplitText__WEBPACK_IMPORTED_MODULE_4__.SplitText.create(el, {
          type: "lines",
          lineClass: "line",
          mask: "lines",
          autoSplit: true
        });
        allLines.push(split.lines);
      });
      allLines.forEach((text, i) => {
        tl.fromTo(text, {
          y: "100%"
        }, {
          y: "0",
          duration: 0.8,
          ease: "zoom",
          stagger: 0.05
        }, "titles -=0.2");
      });
      if (this.elements.altImg) {
        tl.fromTo(this.elements.altImg, {
          y: "20%",
          opacity: 0
        }, {
          y: 0,
          opacity: 1,
          duration: 0.4,
          ease: "power2.out"
        }, '-=0.6');
      }
      tl.fromTo(this.elements.misc, {
        opacity: 0
      }, {
        opacity: 1,
        duration: 0.8,
        ease: 'power2.out'
      });
      tl.call(() => {
        this.enableScrolling();
        resolve();
      });
    });
  }
  preventScrolling() {
    this.lScroll.stop();
    document.documentElement.style.overflow = 'hidden';
    this.elements.body.classList.add('no--scrolling');
  }
  enableScrolling() {
    this.elements.body.classList.remove("no--scrolling");
    document.documentElement.style.overflow = '';
    this.lScroll.start();
  }
  get hasHeroImage() {
    return this.elements.imageHero && !this.elements.imageHero.classList.contains('hidden');
  }
}

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("0e5108cb1af6f8199631")
/******/ })();
/******/ 
/******/ }
);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5jYTdjMzE4YmI2OWE5ZWNmMzczMC5ob3QtdXBkYXRlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUF1QjtBQUNxQjtBQUNGO0FBQ0E7QUFDTjtBQUVyQixNQUFNSyxJQUFJLENBQUM7RUFDeEJDLFdBQVdBLENBQUM7SUFBRUMsRUFBRSxHQUFHLFNBQVM7SUFBRUMsUUFBUSxHQUFHLENBQUM7RUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUU7SUFDbEQsSUFBSSxDQUFDRCxFQUFFLEdBQUdBLEVBQUU7SUFDWixJQUFJLENBQUNFLFNBQVMsR0FBRztNQUNmLEdBQUdELFFBQVE7TUFDWEUsT0FBTyxFQUFFLHdCQUF3QjtNQUNqQ0MsUUFBUSxFQUFFLGtDQUFrQztNQUM1Q0MsUUFBUSxFQUFFLGtDQUFrQztNQUM1Q0MsTUFBTSxFQUFFLGVBQWU7TUFDdkJDLE1BQU0sRUFBRSxxQkFBcUI7TUFDN0JDLFNBQVMsRUFBRSxvQkFBb0I7TUFDL0JDLFVBQVUsRUFBRSwrQkFBK0I7TUFDM0NDLElBQUksRUFBRSxhQUFhO01BQ25CQyxJQUFJLEVBQUUsYUFBYTtNQUNuQkMsSUFBSSxFQUFFLE1BQU07TUFDWkMsRUFBRSxFQUFFLFdBQVc7TUFDZkMsTUFBTSxFQUFFLGdCQUFnQjtNQUN4QkMsTUFBTSxFQUFFO0lBQ1YsQ0FBQztJQUVEakIsSUFBSSxDQUFDa0IsU0FBUyxDQUFDQyxNQUFNLEdBQUdwQixxREFBTTtJQUM5QkosNENBQUksQ0FBQ3lCLGNBQWMsQ0FBQ3hCLHVEQUFVLEVBQUVFLHFEQUFTLENBQUM7SUFDMUNGLHVEQUFVLENBQUN1QixNQUFNLENBQUMsTUFBTSxFQUFFLGtCQUFrQixDQUFDO0lBQzdDLElBQUksQ0FBQ0UsT0FBTyxHQUFHeEIscURBQU07SUFDckIsSUFBSSxDQUFDc0IsTUFBTSxDQUFDLENBQUM7RUFDZjtFQUVBRyxJQUFJQSxDQUFDQyxZQUFZLEVBQUU7SUFDakIsT0FBTyxJQUFJQyxPQUFPLENBQUNDLE9BQU8sSUFB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QUFDMkMsUUFBUSxHQUFHLEVBQUU7SUFDNUMsSUFBSSxDQUFDM0UsT0FBTyxDQUFDNEUsS0FBSyxDQUFDLENBQUM7RUFDdEI7RUFFQSxJQUFJcEUsWUFBWUEsQ0FBQSxFQUFHO0lBQ2pCLE9BQU8sSUFBSSxDQUFDMUIsUUFBUSxDQUFDTyxTQUFTLElBQUksQ0FBQyxJQUFJLENBQUNQLFFBQVEsQ0FBQ08sU0FBUyxDQUFDb0IsU0FBUyxDQUFDQyxRQUFRLENBQUMsUUFBUSxDQUFDO0VBQ3pGO0FBRUYsQzs7Ozs7Ozs7VUMzTkEsc0QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yb29tMTg3Ly4vYXBwL2NsYXNzZXMvUGFnZS5qcyIsIndlYnBhY2s6Ly9yb29tMTg3L3dlYnBhY2svcnVudGltZS9nZXRGdWxsSGFzaCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZ3NhcCBmcm9tICdnc2FwJ1xuaW1wb3J0IHsgQ3VzdG9tRWFzZSB9IGZyb20gXCJnc2FwL0N1c3RvbUVhc2VcIlxuaW1wb3J0IHsgc2Nyb2xsIH0gZnJvbSAndXRpbHMvTGVuaXNTY3JvbGwnXG5pbXBvcnQgeyBTcGxpdFRleHQgfSBmcm9tICdnc2FwL1NwbGl0VGV4dCdcbmltcG9ydCBDcmVhdGUgZnJvbSBcIi4uL3V0aWxzL2NyZWF0ZVwiXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBhZ2Uge1xuICBjb25zdHJ1Y3Rvcih7IGlkID0gJ2RlZmF1bHQnLCBlbGVtZW50cyA9IHt9IH0gPSB7fSkge1xuICAgIHRoaXMuaWQgPSBpZFxuICAgIHRoaXMuc2VsZWN0b3JzID0geyBcbiAgICAgIC4uLmVsZW1lbnRzLFxuICAgICAgb3ZlcmxheTogJ1tkYXRhLXBhZ2UtdHJhbnNpdGlvbl0nLFxuICAgICAgc2xpZGVPbmU6ICdbZGF0YS1wYWdlLXRyYW5zaXRpb24tc2xpZGUtb25lXScsXG4gICAgICBzbGlkZVR3bzogJ1tkYXRhLXBhZ2UtdHJhbnNpdGlvbi1zbGlkZS10d29dJyxcbiAgICAgIGxvYWRlcjogJ1tkYXRhLWxvYWRlcl0nLFxuICAgICAgaW1hZ2VzOiAnW2RhdGEtbG9hZGVyLWltYWdlXScsXG4gICAgICBpbWFnZUhlcm86ICdbZGF0YS1sb2FkZXItaGVyb10nLFxuICAgICAgbWFpblRpdGxlczogJ1tkYXRhLWhlcm9dIFtkYXRhLXNwbGl0LXRleHRdJyxcbiAgICAgIG1pc2M6ICdbZGF0YS1taXNjXScsXG4gICAgICBwYWdlOiAnW2RhdGEtcGFnZV0nLFxuICAgICAgYm9keTogJ2JvZHknLFxuICAgICAgYmc6ICdbZGF0YS1iZ10nLFxuICAgICAgbmF2QmFyOiAnW2RhdGEtbmF2LWJhcl0nLFxuICAgICAgYWx0SW1nOiAnW2RhdGEtYWx0LWhlcm8taW1nXSdcbiAgICB9XG5cbiAgICBQYWdlLnByb3RvdHlwZS5jcmVhdGUgPSBDcmVhdGVcbiAgICBnc2FwLnJlZ2lzdGVyUGx1Z2luKEN1c3RvbUVhc2UsIFNwbGl0VGV4dClcbiAgICBDdXN0b21FYXNlLmNyZWF0ZShcInpvb21cIiwgXCIwLjcxLCAwLCAwLjA2LCAxXCIpXG4gICAgdGhpcy5sU2Nyb2xsID0gc2Nyb2xsICAgIFxuICAgIHRoaXMuY3JlYXRlKClcbiAgfVxuXG4gIHNob3coaXNGaXJzdFZpc2l0KSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgbGV0IHRsID0gZ3NhcC50aW1lbGluZSgpXG4gICAgICBjb25zdCBoYXNIZXJvSW1nID0gdGhpcy5oYXNIZXJvSW1hZ2VcblxuICAgICAgaWYoIXRoaXMuZWxlbWVudHMuYm9keS5jbGFzc0xpc3QuY29udGFpbnMoJ25vLS1zY3JvbGxpbmcnKSkge1xuICAgICAgICB0aGlzLnByZXZlbnRTY3JvbGxpbmcoKVxuICAgICAgfVxuICAgIFxuICAgICAgaWYgKGlzRmlyc3RWaXNpdCkge1xuICAgICAgICB0aGlzLnpvb21BbmltYXRpb24odGwsIGlzRmlyc3RWaXNpdClcbiAgICAgIH0gZWxzZSBpZiAoaGFzSGVyb0ltZykge1xuICAgICAgICB0aGlzLnpvb21BbmltYXRpb24odGwsIGlzRmlyc3RWaXNpdClcbiAgICAgIH1cblxuICAgICAgdGhpcy5hbmltYXRlQXNzZXRzKHRsLCByZXNvbHZlKVxuICAgIH0pXG4gIH1cblxuICBoaWRlKCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgIGxldCBhbmltT3V0ID0gZ3NhcC50aW1lbGluZSgpXG5cbiAgICAgIGFuaW1PdXQudG8odGhpcy5lbGVtZW50cy5vdmVybGF5LCB7XG4gICAgICAgIGNsaXBQYXRoOiBcInBvbHlnb24oMCUgMCUsIDEwMCUgMCUsIDEwMCUgMTAwJSwgMCUgMTAwJSlcIixcbiAgICAgICAgZHVyYXRpb246IDAuNixcbiAgICAgICAgZWFzZTogXCJ6b29tXCJcbiAgICAgIH0pXG5cbiAgICAgIGFuaW1PdXQudG8odGhpcy5lbGVtZW50cy5zbGlkZVR3bywge1xuICAgICAgICBjbGlwUGF0aDogXCJwb2x5Z29uKDAlIDAlLCAxMDAlIDAlLCAxMDAlIDEwMCUsIDAlIDEwMCUpXCIsXG4gICAgICAgIGR1cmF0aW9uOiAwLjYsXG4gICAgICAgIGVhc2U6IFwiem9vbVwiXG4gICAgICB9KS5hZGQocmVzb2x2ZSlcblxuICAgIH0pXG4gIH1cbiAgem9vbUFuaW1hdGlvbih0bCwgc2hvd0Z1bGxBbmltKSB7XG4gICAgaWYoIXRoaXMuZWxlbWVudHMuaW1hZ2VzKSByZXR1cm5cblxuICAgIGNvbnN0IHBhZ2VOYW1lID0gdGhpcy5lbGVtZW50cy5wYWdlPy5kYXRhc2V0Py5wYWdlIHx8ICcnO1xuICAgIGNvbnN0IGlzRXJyb3JQYWdlID0gcGFnZU5hbWUgPT09ICdlcnJvcic7XG4gICAgY29uc3QgaGFzSGVyb0ltZyA9IHRoaXMuaGFzSGVyb0ltYWdlXG4gICAgbGV0IHNtYWxsSGVyb0ltZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWltYWdlLWhlcm89XCJzbWFsbFwiXScpXG5cbiAgICBpZiAoaXNFcnJvclBhZ2UpIHtcbiAgICAgIHRsLnRvKHRoaXMuZWxlbWVudHMubG9hZGVyLCB7IGRpc3BsYXk6IFwiZmxleFwiLCBkdXJhdGlvbjogMC4wMSB9KVxuICAgICAgdGhpcy5zaG93SW1hZ2VzKHRsLCBmYWxzZSlcblxuICAgICAgdGwudG8oe30sIHtcbiAgICAgICAgb25Db21wbGV0ZTogKCkgPT4ge1xuICAgICAgICAgIHRoaXMuZWxlbWVudHMubG9hZGVyLmNsYXNzTGlzdC5hZGQoJ2JnLS1lcnJvcicpXG4gICAgICAgIH1cbiAgICAgIH0sIFwiLT0wLjhcIik7XG5cbiAgICAgIHRsLnRvKHRoaXMuZWxlbWVudHMubG9hZGVyLCB7IGRpc3BsYXk6IFwibm9uZVwiLCBkdXJhdGlvbjogMC4wMSwgb25Db21wbGV0ZTogKCk9PiB7XG4gICAgICAgIHRoaXMuZWxlbWVudHMubG9hZGVyLmNsYXNzTGlzdC5yZW1vdmUoJ2JnLS1lcnJvcicpXG4gICAgICB9fSwgXCIrPTAuNlwiKVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHRsLnRvKHRoaXMuZWxlbWVudHMubG9hZGVyLCB7IGRpc3BsYXk6IFwiZmxleFwiLCBkdXJhdGlvbjogMC4wMSB9KVxuICAgICAgdGhpcy5zaG93SW1hZ2VzKHRsLCBzaG93RnVsbEFuaW0pXG5cbiAgICAgIGlmKGhhc0hlcm9JbWcpIHtcbiAgICAgICAgaWYoc21hbGxIZXJvSW1nKSB7XG4gICAgICAgICAgdGhpcy5lbGVtZW50cy5pbWFnZUhlcm8uc3R5bGUudG9wID0gMFxuICAgICAgICB9XG5cbiAgICAgICAgdGwudG8odGhpcy5lbGVtZW50cy5pbWFnZUhlcm8sIHsgb3BhY2l0eTogMSwgZHVyYXRpb246IDAuMDQsIGVhc2U6IFwibGluZWFyXCIgfSwgXCIrPTAuMTVcIilcbiAgICAgICAgdGwudG8odGhpcy5lbGVtZW50cy5pbWFnZUhlcm8sIHsgc2NhbGU6IDEsIGNsaXBQYXRoOlwicG9seWdvbigwJSAwJSwgMTAwJSAwJSwgMTAwJSAxMDAlLCAwJSAxMDAlKVwiLCBkdXJhdGlvbjogMC42LCBlYXNlOiBcInpvb21cIiB9LCBcIis9MC40XCIpXG5cbiAgICAgICAgaWYoc21hbGxIZXJvSW1nKSB7XG4gICAgICAgICAgbGV0IGltZ0hlaWdodCA9IHNtYWxsSGVyb0ltZy5vZmZzZXRIZWlnaHRcbiAgICAgICAgICBsZXQgbG9hZGVySW1ncyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWxvYWRlci1pbWFnZV06bm90KFtkYXRhLWxvYWRlci1oZXJvXSknKVxuXG4gICAgICAgICAgdGwudG8obG9hZGVySW1ncywgeyBvcGFjaXR5OiAwLCBkdXJhdGlvbjogMC4wMSwgZWFzZTogXCJsaW5lYXJcIiB9KVxuICAgICAgICAgICAgLnRvKHRoaXMuZWxlbWVudHMuaW1hZ2VIZXJvLCB7IGhlaWdodDogaW1nSGVpZ2h0LCBkdXJhdGlvbjogMC42LCBlYXNlOiBcInpvb21cIiB9KVxuICAgICAgICB9XG5cbiAgICAgICAgdGwudG8odGhpcy5lbGVtZW50cy5sb2FkZXIsIHsgZGlzcGxheTogXCJub25lXCIsIGR1cmF0aW9uOiAwLjAxLCBcbiAgICAgICAgICBvbkNvbXBsZXRlOiAoKSA9PiB7XG4gICAgICAgICAgICB0bC50byh0aGlzLmVsZW1lbnRzLmltYWdlSGVybywgeyBzY2FsZTogMC41LCBjbGlwUGF0aDpcInBvbHlnb24oMjAlIDEwJSwgODAlIDEwJSwgODAlIDkwJSwgMjAlIDkwJSlcIiwgZHVyYXRpb246IDAuMDEgfSlcbiAgICAgICAgICAgIGlmKHNtYWxsSGVyb0ltZykge1xuICAgICAgICAgICAgICB0aGlzLmVsZW1lbnRzLmltYWdlSGVyby5zdHlsZS5oZWlnaHQgPSAnJ1xuICAgICAgICAgICAgICB0aGlzLmVsZW1lbnRzLmltYWdlSGVyby5zdHlsZS50b3AgPSAnJ1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGwudG8odGhpcy5lbGVtZW50cy5sb2FkZXIsIHsgZGlzcGxheTogXCJub25lXCIsIGR1cmF0aW9uOiAwLjAxfSwgXCIrPTAuNlwiKVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICB0bC50byh0aGlzLmVsZW1lbnRzLmltYWdlcywgeyBvcGFjaXR5OiAwLCBkdXJhdGlvbjogMC4wMSwgZWFzZTogXCJsaW5lYXJcIiB9KVxuICAgIFxuICB9XG5cbiAgc2hvd0ltYWdlcyh0bCwgc2hvd0Z1bGxBbmltKSB7XG4gICAgaWYoc2hvd0Z1bGxBbmltKSB7XG4gICAgICB0aGlzLmVsZW1lbnRzLmltYWdlcy5mb3JFYWNoKChpbWcsIGkpID0+IHtcbiAgICAgICAgdGwudG8oaW1nLCB7IG9wYWNpdHk6IDEsIGR1cmF0aW9uOiAwLjA0LCBlYXNlOiBcImxpbmVhclwiIH0sIFwiKz0wLjE1XCIpXG4gICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE1hdGgubWluKDQsIHRoaXMuZWxlbWVudHMuaW1hZ2VzLmxlbmd0aCk7IGkrKykge1xuICAgICAgICB0bC50byh0aGlzLmVsZW1lbnRzLmltYWdlc1tpXSwge1xuICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgZHVyYXRpb246IDAuMDQsXG4gICAgICAgICAgZWFzZTogXCJsaW5lYXJcIixcbiAgICAgICAgfSwgXCIrPTAuMTVcIik7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYW5pbWF0ZUFzc2V0cyh0bCwgcmVzb2x2ZSkge1xuICAgIGdzYXAuc2V0KHRoaXMuZWxlbWVudHMub3ZlcmxheSwgeyBjbGlwUGF0aDogXCJwb2x5Z29uKDAlIDEwMCUsIDEwMCUgMTAwJSwgMTAwJSAxMDAlLCAwJSAxMDAlKVwiIH0pXG4gICAgZ3NhcC5zZXQodGhpcy5lbGVtZW50cy5zbGlkZVR3bywgeyBjbGlwUGF0aDogXCJwb2x5Z29uKDAlIDEwMCUsIDEwMCUgMTAwJSwgMTAwJSAxMDAlLCAwJSAxMDAlKVwiIH0pXG4gICAgXG4gICAgaWYgKCF0aGlzLmVsZW1lbnRzLm1haW5UaXRsZXMgfHwgdGhpcy5lbGVtZW50cy5tYWluVGl0bGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc29sZS53YXJuKCdtYWluVGl0bGVzIG5vdCBmb3VuZCBvciBlbXB0eTonLCB0aGlzLmVsZW1lbnRzLm1haW5UaXRsZXMpXG4gICAgfVxuXG4gICAgZG9jdW1lbnQuZm9udHMucmVhZHkudGhlbigoKSA9PiB7XG4gICAgICBjb25zdCBoZXJvVGl0bGVzID0gKHRoaXMuZWxlbWVudHMubWFpblRpdGxlcyBpbnN0YW5jZW9mIE5vZGVMaXN0IHx8IEFycmF5LmlzQXJyYXkodGhpcy5lbGVtZW50cy5tYWluVGl0bGVzKSlcbiAgICAgID8gQXJyYXkuZnJvbSh0aGlzLmVsZW1lbnRzLm1haW5UaXRsZXMpXG4gICAgICA6IHRoaXMuZWxlbWVudHMubWFpblRpdGxlc1xuICAgICAgICA/IFt0aGlzLmVsZW1lbnRzLm1haW5UaXRsZXNdXG4gICAgICAgIDogW107XG5cbiAgICAgIGNvbnN0IGFsbExpbmVzID0gW107XG4gICAgICBcbiAgICAgIGhlcm9UaXRsZXMuZm9yRWFjaCgoZWwpID0+IHtcbiAgICAgICAgY29uc3Qgc3BsaXQgPSBTcGxpdFRleHQuY3JlYXRlKGVsLCBcbiAgICAgICAgICB7XG4gICAgICAgICAgICB0eXBlOiBcImxpbmVzXCIsXG4gICAgICAgICAgICBsaW5lQ2xhc3M6IFwibGluZVwiLFxuICAgICAgICAgICAgbWFzazogXCJsaW5lc1wiLFxuICAgICAgICAgICAgYXV0b1NwbGl0OiB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICApXG5cbiAgICAgICAgYWxsTGluZXMucHVzaChzcGxpdC5saW5lcylcbiAgICAgIH0pXG5cbiAgICAgIGFsbExpbmVzLmZvckVhY2goKHRleHQsIGkpID0+IHtcbiAgICAgICAgdGwuZnJvbVRvKHRleHQsXG4gICAgICAgICAgeyB5OiBcIjEwMCVcIn0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgeTogXCIwXCIsIFxuICAgICAgICAgICAgZHVyYXRpb246IDAuOCwgXG4gICAgICAgICAgICBlYXNlOiBcInpvb21cIixcbiAgICAgICAgICAgIHN0YWdnZXI6IDAuMDVcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwidGl0bGVzIC09MC4yXCJcbiAgICAgICAgKVxuICAgICAgfSlcblxuICAgICAgaWYodGhpcy5lbGVtZW50cy5hbHRJbWcpIHtcbiAgICAgICAgdGwuZnJvbVRvKHRoaXMuZWxlbWVudHMuYWx0SW1nLCB7IHk6IFwiMjAlXCIsIG9wYWNpdHk6IDAgfSwgeyB5OiAwLCBvcGFjaXR5OiAxLCBkdXJhdGlvbjogMC40LCBlYXNlOiBcInBvd2VyMi5vdXRcIiB9LCAnLT0wLjYnKVxuICAgICAgfVxuXG4gICAgICB0bC5mcm9tVG8odGhpcy5lbGVtZW50cy5taXNjLCB7IG9wYWNpdHk6IDAgfSwgeyBvcGFjaXR5OiAxLCBkdXJhdGlvbjogMC44LCBlYXNlOiAncG93ZXIyLm91dCcgfSlcbiAgICAgIFxuICAgICAgdGwuY2FsbCgoKSA9PiB7XG4gICAgICAgIHRoaXMuZW5hYmxlU2Nyb2xsaW5nKClcbiAgICAgICAgcmVzb2x2ZSgpXG4gICAgICB9KVxuICAgIH0pXG4gIH1cblxuICBwcmV2ZW50U2Nyb2xsaW5nKCkge1xuICAgIHRoaXMubFNjcm9sbC5zdG9wKClcbiAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcbiAgICB0aGlzLmVsZW1lbnRzLmJvZHkuY2xhc3NMaXN0LmFkZCgnbm8tLXNjcm9sbGluZycpXG4gIH1cblxuICBlbmFibGVTY3JvbGxpbmcoKSB7XG4gICAgdGhpcy5lbGVtZW50cy5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoXCJuby0tc2Nyb2xsaW5nXCIpXG4gICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLm92ZXJmbG93ID0gJydcbiAgICB0aGlzLmxTY3JvbGwuc3RhcnQoKVxuICB9XG5cbiAgZ2V0IGhhc0hlcm9JbWFnZSgpIHtcbiAgICByZXR1cm4gdGhpcy5lbGVtZW50cy5pbWFnZUhlcm8gJiYgIXRoaXMuZWxlbWVudHMuaW1hZ2VIZXJvLmNsYXNzTGlzdC5jb250YWlucygnaGlkZGVuJyk7XG4gIH0gXG5cbn0iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmggPSAoKSA9PiAoXCIwZTUxMDhjYjFhZjZmODE5OTYzMVwiKSJdLCJuYW1lcyI6WyJnc2FwIiwiQ3VzdG9tRWFzZSIsInNjcm9sbCIsIlNwbGl0VGV4dCIsIkNyZWF0ZSIsIlBhZ2UiLCJjb25zdHJ1Y3RvciIsImlkIiwiZWxlbWVudHMiLCJzZWxlY3RvcnMiLCJvdmVybGF5Iiwic2xpZGVPbmUiLCJzbGlkZVR3byIsImxvYWRlciIsImltYWdlcyIsImltYWdlSGVybyIsIm1haW5UaXRsZXMiLCJtaXNjIiwicGFnZSIsImJvZHkiLCJiZyIsIm5hdkJhciIsImFsdEltZyIsInByb3RvdHlwZSIsImNyZWF0ZSIsInJlZ2lzdGVyUGx1Z2luIiwibFNjcm9sbCIsInNob3ciLCJpc0ZpcnN0VmlzaXQiLCJQcm9taXNlIiwicmVzb2x2ZSIsInRsIiwidGltZWxpbmUiLCJoYXNIZXJvSW1nIiwiaGFzSGVyb0ltYWdlIiwiY2xhc3NMaXN0IiwiY29udGFpbnMiLCJwcmV2ZW50U2Nyb2xsaW5nIiwiem9vbUFuaW1hdGlvbiIsImFuaW1hdGVBc3NldHMiLCJoaWRlIiwiYW5pbU91dCIsInRvIiwiY2xpcFBhdGgiLCJkdXJhdGlvbiIsImVhc2UiLCJhZGQiLCJzaG93RnVsbEFuaW0iLCJwYWdlTmFtZSIsImRhdGFzZXQiLCJpc0Vycm9yUGFnZSIsInNtYWxsSGVyb0ltZyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImRpc3BsYXkiLCJzaG93SW1hZ2VzIiwib25Db21wbGV0ZSIsInJlbW92ZSIsInN0eWxlIiwidG9wIiwib3BhY2l0eSIsInNjYWxlIiwiaW1nSGVpZ2h0Iiwib2Zmc2V0SGVpZ2h0IiwibG9hZGVySW1ncyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJoZWlnaHQiLCJmb3JFYWNoIiwiaW1nIiwiaSIsIk1hdGgiLCJtaW4iLCJsZW5ndGgiLCJzZXQiLCJjb25zb2xlIiwid2FybiIsImZvbnRzIiwicmVhZHkiLCJ0aGVuIiwiaGVyb1RpdGxlcyIsIk5vZGVMaXN0IiwiQXJyYXkiLCJpc0FycmF5IiwiZnJvbSIsImFsbExpbmVzIiwiZWwiLCJzcGxpdCIsInR5cGUiLCJsaW5lQ2xhc3MiLCJtYXNrIiwiYXV0b1NwbGl0IiwicHVzaCIsImxpbmVzIiwidGV4dCIsImZyb21UbyIsInkiLCJzdGFnZ2VyIiwiY2FsbCIsImVuYWJsZVNjcm9sbGluZyIsInN0b3AiLCJkb2N1bWVudEVsZW1lbnQiLCJvdmVyZmxvdyIsInN0YXJ0Il0sInNvdXJjZVJvb3QiOiIifQ==