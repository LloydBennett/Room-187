"use strict";
self["webpackHotUpdateroom187"]("main",{

/***/ "./app/pages/Gallery/index.js":
/*!************************************!*\
  !*** ./app/pages/Gallery/index.js ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ Gallery)
/* harmony export */ });
/* harmony import */ var classes_Page__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! classes/Page */ "./app/classes/Page.js");
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gsap */ "./node_modules/gsap/index.js");
/* harmony import */ var utils_LenisScroll__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/LenisScroll */ "./app/utils/LenisScroll.js");
/* harmony import */ var gsap_CustomEase__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gsap/CustomEase */ "./node_modules/gsap/CustomEase.js");




class Gallery extends classes_Page__WEBPACK_IMPORTED_MODULE_0__["default"] {
  constructor() {
    super({
      id: 'gallery',
      elements: {
        gallery: '[data-gallery]',
        galleryItems: '[data-gallery-item]',
        slideShow: '[data-slideshow]',
        prev: '[data-slideshow-prev]',
        next: '[data-slideshow-next]',
        close: '[data-slideshow] [data-close]',
        slideShowContainer: '[data-slideshow-container]',
        slideShowCounter: '[data-slideshow-index]',
        miniMap: '[data-mini-map]',
        miniMapItems: '[data-mini-map-item]',
        miniMapIndicator: '[data-mini-map-indicator]'
      }
    });
    gsap__WEBPACK_IMPORTED_MODULE_2__["default"].registerPlugin(gsap_CustomEase__WEBPACK_IMPORTED_MODULE_3__.CustomEase);
    gsap_CustomEase__WEBPACK_IMPORTED_MODULE_3__.CustomEase.create("zoom", "0.71, 0, 0.06, 1");
    this.tl = gsap__WEBPACK_IMPORTED_MODULE_2__["default"].timeline();
    this.currentIndex = 0;
    this.media = [];
    this.scroll = utils_LenisScroll__WEBPACK_IMPORTED_MODULE_1__.scroll;
    this.hasMediaBeenSet = false;
    this.isHovered = false;
    this.scrollSpeed = 1;
    this.duplicatedItems = [];
    this.allowSlideNavigation = false;
    this.init();
  }
  openSlideShow(e) {
    const mediaElement = e.target;
    const mediaId = mediaElement.dataset.galleryId;
    this.currentIndex = this.media.findIndex(media => media.dataset.galleryId === mediaId);
    this.displayIndex();
    this.scroll.stop();
    this.tl.clear();
    this.tl.to(this.elements.galleryItems, {
      clipPath: "polygon(0% 100%, 100% 100%, 100% 100%, 0% 100%)",
      duration: 0.6,
      ease: "zoom"
    });
    this.tl.to(this.elements.slideShow, {
      clipPath: "polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)",
      duration: 0.6,
      ease: "zoom",
      onComplete: () => {
        this.elements.slideShow.classList.remove('cannot-interact');
        this.showMedia();
        this.enableSlideNavigation();
      }
    });
    this.tl.to(this.elements.close, {
      opacity: 1,
      duration: 0.3,
      ease: "power2.out"
    });
    this.tl.to(this.elements.prev, {
      opacity: 1,
      duration: 0.3,
      ease: "power2.out"
    }, 'controls');
    this.tl.to(this.elements.next, {
      opacity: 1,
      duration: 0.3,
      ease: "power2.out"
    }, 'controls');
  }
  closeSlideShow() {
    this.disableSlideNavigation();
    let slideShowMedia = document.querySelector('.slideshow-media__item');
    this.elements.slideShow.classList.add('cannot-interact');
    this.tl.to(this.elements.slideShow, {
      clipPath: "polygon(0% 100%, 100% 100%, 100% 100%, 0% 100%)",
      duration: 0.6,
      ease: "zoom",
      onComplete: () => {
        slideShowMedia.remove();
        this.hasMediaBeenSet = false;
        this.scroll.start();
        this.animateImages(false, true);
      }
    });
    this.tl.to(this.elements.close, {
      opacity: 0,
      duration: 0.001
    }, 'hide');
    this.tl.to(this.elements.prev, {
      opacity: 0,
      duration: 0.001
    }, 'hide');
    this.tl.to(this.elements.next, {
      opacity: 0,
      duration: 0.001
    }, 'hide');

    // Remove image parameter from URL
    const newUrl = new URL(window.location);
    newUrl.searchParams.delete("media");
    window.history.pushState({}, "", newUrl);
  }
  changeMedia(direction) {
    const oldIndex = this.currentIndex;
    this.currentIndex = (this.currentIndex + direction + this.media.length) % this.media.length;
    this.displayIndex();
    if (oldIndex === this.currentIndex) return;
    if (this.tl.isActive()) {
      this.tl.add(() => {
        this.showMedia();
      });
    } else {
      this.showMedia();
    }
  }
  showMedia() {
    const mediaCurrentElem = this.media[this.currentIndex];
    const mediaType = mediaCurrentElem.dataset.galleryItem;
    const mediaId = mediaCurrentElem.dataset.galleryId;
    this.updateMinimapIndicator(mediaId);

    // If the same media, don't do anything
    if (this.elements.slideShowContainer.querySelector(`[data-slideshow-id="${mediaId}"]`)) {
      return;
    }
    if (!this.hasMediaBeenSet) {
      this.createAndSetMediaElement(mediaCurrentElem, mediaType);
      this.hasMediaBeenSet = true;
    } else {
      this.swapMediaElement(mediaCurrentElem, mediaType);
    }

    // Update the URL with the new image ID
    const newUrl = new URL(window.location);
    newUrl.searchParams.set("media", mediaId);
    window.history.pushState({}, "", newUrl);
  }
  createAndSetMediaElement(mediaElem, mediaType) {
    const newElem = this.createNewMediaItem(mediaType);
    this.setMediaAttributes(newElem, mediaElem, mediaType);
    this.elements.slideShowContainer.innerHTML = ''; // Clear previous elements
    this.elements.slideShowContainer.appendChild(newElem);
    gsap__WEBPACK_IMPORTED_MODULE_2__["default"].fromTo(newElem, {
      clipPath: "polygon(0% 100%, 100% 100%, 100% 100%, 0% 100%)"
    }, {
      clipPath: "polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)",
      duration: 0.6,
      ease: "zoom"
    });
  }
  displayIndex() {
    this.elements.slideShowCounter.innerHTML = String(this.currentIndex + 1).padStart(2, '0');
  }
  swapMediaElement(mediaElem, mediaType) {
    const oldElem = this.elements.slideShowContainer.firstChild;
    const newElem = this.createNewMediaItem(mediaType);
    this.setMediaAttributes(newElem, mediaElem, mediaType);
    this.elements.slideShowContainer.appendChild(newElem);
    this.tl.fromTo(newElem, {
      clipPath: "polygon(0% 100%, 100% 100%, 100% 100%, 0% 100%)"
    }, {
      clipPath: "polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)",
      duration: 0.6,
      ease: "zoom"
    });
    this.tl.to(oldElem, {
      clipPath: "polygon(0% 100%, 100% 100%, 100% 100%, 0% 100%)",
      duration: 0.6,
      ease: "power2.out",
      onComplete: () => {
        oldElem.remove();
      }
    }, "-=0.2");
  }
  setupScrollNavigation() {
    let ticking = false;
    window.addEventListener('wheel', e => {
      if (!this.allowSlideNavigation || ticking) return;
      ticking = true;
      const direction = e.deltaY > 0 ? 1 : -1;
      this.changeMedia(direction);
      setTimeout(() => {
        ticking = false;
      }, 600); // delay to prevent overscroll
    });
  }
  setupSwipeNavigation() {
    let touchStartX = 0;
    let touchEndX = 0;
    console.log('yep');
    const threshold = 50; // Minimum swipe distance

    const container = this.elements.slideShowContainer;
    container.addEventListener('touchstart', e => {
      touchStartX = e.changedTouches[0].screenX;
    });
    container.addEventListener('touchend', e => {
      touchEndX = e.changedTouches[0].screenX;
      handleSwipe();
    });
    const handleSwipe = () => {
      if (!this.allowSlideNavigation) return;
      const delta = touchStartX - touchEndX;
      if (Math.abs(delta) > threshold) {
        const direction = delta > 0 ? 1 : -1;
        this.changeMedia(direction);
      }
    };
  }
  disableSlideNavigation() {
    this.allowSlideNavigation = false;
  }
  enableSlideNavigation() {
    this.allowSlideNavigation = true;
  }
  createNewMediaItem(type) {
    const elem = type === "video" ? document.createElement('video') : document.createElement('img');
    elem.classList.add('slideshow-media__item');
    return elem;
  }
  setMediaAttributes(elem, mediaElem, mediaType) {
    const mediaId = mediaElem.dataset.galleryId;
    elem.setAttribute('data-slideshow-id', mediaId);
    if (mediaType === "video") {
      elem.setAttribute('autoplay', '');
      elem.setAttribute('muted', '');
      elem.setAttribute('loop', '');
      const source = document.createElement('source');
      source.src = mediaElem.querySelector("source").src;
      source.type = "video/mp4";
      elem.appendChild(source);
    } else {
      elem.src = mediaElem.dataset.gallerySrc;
      elem.alt = mediaElem.alt || "Gallery Image";
    }
  }
  updateMinimapIndicator(mediaId = this.media[this.currentIndex]?.dataset.galleryId) {
    if (!mediaId) return;
    let miniMapRect = this.elements.miniMap.getBoundingClientRect();
    this.elements.miniMapItems.forEach((item, i) => {
      if (item.dataset.galleryId === mediaId) {
        let itemRect = item.getBoundingClientRect();
        const targetX = -item.offsetLeft;
        const indicatorXpos = itemRect.left - miniMapRect.left;
        gsap__WEBPACK_IMPORTED_MODULE_2__["default"].to(this.elements.miniMapIndicator, {
          x: indicatorXpos,
          duration: 0.4,
          ease: "zoom"
        });
        gsap__WEBPACK_IMPORTED_MODULE_2__["default"].to(this.elements.miniMap, {
          x: targetX,
          duration: 0.4,
          ease: "power3.out"
        });
      } else {
        item.classList.remove('minimap-item--active');
      }
    });
  }

  // Check URL on Page Load & Open Slideshow if Needed
  checkURLForSlideShow() {
    window.addEventListener("DOMContentLoaded", () => {
      const urlParams = new URLSearchParams(window.location.search);
      const mediaId = urlParams.get("media");
      if (mediaId) {
        const mediaElement = document.querySelector(`[data-gallery-id="${mediaId}"]`);
        if (mediaElement) this.openSlideShow({
          target: mediaElement
        });
      }
    });
  }
  animateImages(useStrollTrigger, show = true) {
    let clipPathPoly = show ? "polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)" : "polygon(0% 100%, 100% 100%, 100% 100%, 0% 100%)";
    if (useStrollTrigger) {
      gsap__WEBPACK_IMPORTED_MODULE_2__["default"].to(this.elements.galleryItems, {
        clipPath: clipPathPoly,
        duration: 0.6,
        scrollTrigger: {
          trigger: this.elements.galleryItems,
          start: 'top bottom',
          scrub: false,
          markers: false
        },
        ease: "zoom"
      });
    } else {
      gsap__WEBPACK_IMPORTED_MODULE_2__["default"].to(this.elements.galleryItems, {
        clipPath: clipPathPoly,
        duration: 0.6,
        ease: "zoom"
      });
    }
  }
  animateAssets(tl, resolve) {
    super.animateAssets(tl, () => {
      this.animateImages(true);
      resolve();
    });
  }
  handleResize = () => {
    this.updateMinimapIndicator();
  };

  // Debounce helper (avoids spamming during resize)
  debounce(fn, delay = 100) {
    let timeout;
    return () => {
      clearTimeout(timeout);
      timeout = setTimeout(fn, delay);
    };
  }
  addEventListeners() {
    if (!this.elements.galleryItems || !this.elements.close) return;
    gsap__WEBPACK_IMPORTED_MODULE_2__["default"].set(this.elements.galleryItems, {
      clipPath: "polygon(0% 100%, 100% 100%, 100% 100%, 0% 100%)"
    });
    if (Array.isArray(this.elements.galleryItems) || typeof this.elements.galleryItems === 'object') {
      this.media = Array.from(this.elements.galleryItems);
      this.elements.galleryItems.forEach(element => {
        element.addEventListener('click', e => {
          this.openSlideShow(e);
        });
      });
    } else {
      this.elements.galleryItems.addEventListener('click', e => {
        this.openSlideShow(e);
      });
    }
    if (this.elements.prev) {
      this.elements.prev.addEventListener('click', () => {
        this.changeMedia(-1);
      });
    }
    if (this.elements.next) {
      this.elements.next.addEventListener('click', () => {
        this.changeMedia(1);
      });
    }
    this.elements.close.addEventListener('click', () => {
      this.closeSlideShow();
    });
    window.addEventListener('resize', this.debounce(this.handleResize));
  }
  init() {
    this.addEventListeners();
    this.checkURLForSlideShow();
    this.setupSwipeNavigation();
    this.setupScrollNavigation();
  }
}

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("b4ca25cb59a8ae68ec7a")
/******/ })();
/******/ 
/******/ }
);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q3NILGlCQUFpQixDQUFDLENBQUM7SUFDeEIsSUFBSSxDQUFDcEIsb0JBQW9CLENBQUMsQ0FBQztJQUMzQixJQUFJLENBQUNoQyxvQkFBb0IsQ0FBQyxDQUFDO0lBQzNCLElBQUksQ0FBQ0wscUJBQXFCLENBQUMsQ0FBQztFQUM5QjtBQUNGLEM7Ozs7Ozs7O1VDdllBLHNEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcm9vbTE4Ny8uL2FwcC9wYWdlcy9HYWxsZXJ5L2luZGV4LmpzIiwid2VicGFjazovL3Jvb20xODcvd2VicGFjay9ydW50aW1lL2dldEZ1bGxIYXNoIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBQYWdlIGZyb20gJ2NsYXNzZXMvUGFnZSdcbmltcG9ydCBnc2FwIGZyb20gJ2dzYXAnXG5pbXBvcnQgeyBzY3JvbGwgfSBmcm9tICd1dGlscy9MZW5pc1Njcm9sbCdcbmltcG9ydCB7IEN1c3RvbUVhc2UgfSBmcm9tICdnc2FwL0N1c3RvbUVhc2UnXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdhbGxlcnkgZXh0ZW5kcyBQYWdlIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoe1xuICAgICAgaWQ6ICdnYWxsZXJ5JyxcbiAgICAgIGVsZW1lbnRzOiB7XG4gICAgICAgIGdhbGxlcnk6ICdbZGF0YS1nYWxsZXJ5XScsXG4gICAgICAgIGdhbGxlcnlJdGVtczogJ1tkYXRhLWdhbGxlcnktaXRlbV0nLFxuICAgICAgICBzbGlkZVNob3c6ICdbZGF0YS1zbGlkZXNob3ddJyxcbiAgICAgICAgcHJldjogJ1tkYXRhLXNsaWRlc2hvdy1wcmV2XScsXG4gICAgICAgIG5leHQ6ICdbZGF0YS1zbGlkZXNob3ctbmV4dF0nLFxuICAgICAgICBjbG9zZTogJ1tkYXRhLXNsaWRlc2hvd10gW2RhdGEtY2xvc2VdJyxcbiAgICAgICAgc2xpZGVTaG93Q29udGFpbmVyOiAnW2RhdGEtc2xpZGVzaG93LWNvbnRhaW5lcl0nLFxuICAgICAgICBzbGlkZVNob3dDb3VudGVyOiAnW2RhdGEtc2xpZGVzaG93LWluZGV4XScsXG4gICAgICAgIG1pbmlNYXA6ICdbZGF0YS1taW5pLW1hcF0nLFxuICAgICAgICBtaW5pTWFwSXRlbXM6ICdbZGF0YS1taW5pLW1hcC1pdGVtXScsXG4gICAgICAgIG1pbmlNYXBJbmRpY2F0b3I6ICdbZGF0YS1taW5pLW1hcC1pbmRpY2F0b3JdJ1xuICAgICAgfVxuICAgIH0pXG5cbiAgICBnc2FwLnJlZ2lzdGVyUGx1Z2luKEN1c3RvbUVhc2UpXG4gICAgQ3VzdG9tRWFzZS5jcmVhdGUoXCJ6b29tXCIsIFwiMC43MSwgMCwgMC4wNiwgMVwiKVxuXG4gICAgdGhpcy50bCA9IGdzYXAudGltZWxpbmUoKVxuICAgIHRoaXMuY3VycmVudEluZGV4ID0gMFxuICAgIHRoaXMubWVkaWEgPSBbXVxuICAgIHRoaXMuc2Nyb2xsID0gc2Nyb2xsXG4gICAgdGhpcy5oYXNNZWRpYUJlZW5TZXQgPSBmYWxzZVxuICAgIHRoaXMuaXNIb3ZlcmVkID0gZmFsc2VcbiAgICB0aGlzLnNjcm9sbFNwZWVkID0gMVxuICAgIHRoaXMuZHVwbGljYXRlZEl0ZW1zID0gW11cblxuICAgIHRoaXMuYWxsb3dTbGlkZU5hdmlnYXRpb24gPSBmYWxzZVxuICAgIFxuICAgIHRoaXMuaW5pdCgpXG4gIH1cblxuICBvcGVuU2xpZGVTaG93KGUpIHtcbiAgICBjb25zdCBtZWRpYUVsZW1lbnQgPSBlLnRhcmdldDtcbiAgICBjb25zdCBtZWRpYUlkID0gbWVkaWFFbGVtZW50LmRhdGFzZXQuZ2FsbGVyeUlkO1xuXG4gICAgdGhpcy5jdXJyZW50SW5kZXggPSB0aGlzLm1lZGlhLmZpbmRJbmRleChtZWRpYSA9PiBtZWRpYS5kYXRhc2V0LmdhbGxlcnlJZCA9PT0gbWVkaWFJZClcbiAgICB0aGlzLmRpc3BsYXlJbmRleCgpXG4gICAgdGhpcy5zY3JvbGwuc3RvcCgpXG4gICAgdGhpcy50bC5jbGVhcigpXG5cbiAgICB0aGlzLnRsLnRvKHRoaXMuZWxlbWVudHMuZ2FsbGVyeUl0ZW1zLCB7IFxuICAgICAgY2xpcFBhdGg6IFwicG9seWdvbigwJSAxMDAlLCAxMDAlIDEwMCUsIDEwMCUgMTAwJSwgMCUgMTAwJSlcIiwgXG4gICAgICBkdXJhdGlvbjogMC42LFxuICAgICAgZWFzZTogXCJ6b29tXCJcbiAgICB9KVxuXG4gICAgdGhpcy50bC50byh0aGlzLmVsZW1lbnRzLnNsaWRlU2hvdywge1xuICAgICAgY2xpcFBhdGg6IFwicG9seWdvbigwJSAwJSwgMTAwJSAwJSwgMTAwJSAxMDAlLCAwJSAxMDAlKVwiLFxuICAgICAgZHVyYXRpb246IDAuNixcbiAgICAgIGVhc2U6IFwiem9vbVwiLFxuICAgICAgb25Db21wbGV0ZTogKCkgPT4ge1xuICAgICAgICB0aGlzLmVsZW1lbnRzLnNsaWRlU2hvdy5jbGFzc0xpc3QucmVtb3ZlKCdjYW5ub3QtaW50ZXJhY3QnKVxuICAgICAgICB0aGlzLnNob3dNZWRpYSgpXG4gICAgICAgIHRoaXMuZW5hYmxlU2xpZGVOYXZpZ2F0aW9uKClcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgdGhpcy50bC50byh0aGlzLmVsZW1lbnRzLmNsb3NlLCB7IG9wYWNpdHk6IDEsIGR1cmF0aW9uOiAwLjMsIGVhc2U6IFwicG93ZXIyLm91dFwiIH0pXG4gICAgdGhpcy50bC50byh0aGlzLmVsZW1lbnRzLnByZXYsIHsgb3BhY2l0eTogMSwgZHVyYXRpb246IDAuMywgZWFzZTogXCJwb3dlcjIub3V0XCIgfSwgJ2NvbnRyb2xzJylcbiAgICB0aGlzLnRsLnRvKHRoaXMuZWxlbWVudHMubmV4dCwgeyBvcGFjaXR5OiAxLCBkdXJhdGlvbjogMC4zLCBlYXNlOiBcInBvd2VyMi5vdXRcIiB9LCAnY29udHJvbHMnKVxuICB9XG5cbiAgY2xvc2VTbGlkZVNob3coKSB7XG4gICAgdGhpcy5kaXNhYmxlU2xpZGVOYXZpZ2F0aW9uKClcbiAgICBsZXQgc2xpZGVTaG93TWVkaWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2xpZGVzaG93LW1lZGlhX19pdGVtJylcbiAgICB0aGlzLmVsZW1lbnRzLnNsaWRlU2hvdy5jbGFzc0xpc3QuYWRkKCdjYW5ub3QtaW50ZXJhY3QnKVxuXG4gICAgdGhpcy50bC50byh0aGlzLmVsZW1lbnRzLnNsaWRlU2hvdywge1xuICAgICAgY2xpcFBhdGg6IFwicG9seWdvbigwJSAxMDAlLCAxMDAlIDEwMCUsIDEwMCUgMTAwJSwgMCUgMTAwJSlcIixcbiAgICAgIGR1cmF0aW9uOiAwLjYsXG4gICAgICBlYXNlOiBcInpvb21cIixcbiAgICAgIG9uQ29tcGxldGU6ICgpID0+IHtcbiAgICAgICAgc2xpZGVTaG93TWVkaWEucmVtb3ZlKClcbiAgICAgICAgdGhpcy5oYXNNZWRpYUJlZW5TZXQgPSBmYWxzZVxuICAgICAgICB0aGlzLnNjcm9sbC5zdGFydCgpXG4gICAgICAgIHRoaXMuYW5pbWF0ZUltYWdlcyhmYWxzZSwgdHJ1ZSlcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgdGhpcy50bC50byh0aGlzLmVsZW1lbnRzLmNsb3NlLCB7IG9wYWNpdHk6IDAsIGR1cmF0aW9uOiAwLjAwMSB9LCAnaGlkZScpXG4gICAgdGhpcy50bC50byh0aGlzLmVsZW1lbnRzLnByZXYsIHsgb3BhY2l0eTogMCwgZHVyYXRpb246IDAuMDAxIH0sICdoaWRlJylcbiAgICB0aGlzLnRsLnRvKHRoaXMuZWxlbWVudHMubmV4dCwgeyBvcGFjaXR5OiAwLCBkdXJhdGlvbjogMC4wMDEgfSwgJ2hpZGUnKVxuICAgIFxuICAgIC8vIFJlbW92ZSBpbWFnZSBwYXJhbWV0ZXIgZnJvbSBVUkxcbiAgICBjb25zdCBuZXdVcmwgPSBuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbik7XG4gICAgbmV3VXJsLnNlYXJjaFBhcmFtcy5kZWxldGUoXCJtZWRpYVwiKTtcbiAgICB3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUoe30sIFwiXCIsIG5ld1VybCk7XG4gIH1cbiAgXG4gIGNoYW5nZU1lZGlhKGRpcmVjdGlvbikge1xuICAgIGNvbnN0IG9sZEluZGV4ID0gdGhpcy5jdXJyZW50SW5kZXhcbiAgICB0aGlzLmN1cnJlbnRJbmRleCA9ICh0aGlzLmN1cnJlbnRJbmRleCArIGRpcmVjdGlvbiArIHRoaXMubWVkaWEubGVuZ3RoKSAlIHRoaXMubWVkaWEubGVuZ3RoXG4gICAgdGhpcy5kaXNwbGF5SW5kZXgoKVxuICAgIGlmIChvbGRJbmRleCA9PT0gdGhpcy5jdXJyZW50SW5kZXgpIHJldHVyblxuXG4gICAgaWYgKHRoaXMudGwuaXNBY3RpdmUoKSkge1xuICAgICAgdGhpcy50bC5hZGQoKCkgPT4ge1xuICAgICAgICB0aGlzLnNob3dNZWRpYSgpO1xuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zaG93TWVkaWEoKTtcbiAgICB9XG4gIH1cblxuICBzaG93TWVkaWEoKSB7XG4gICAgY29uc3QgbWVkaWFDdXJyZW50RWxlbSA9IHRoaXMubWVkaWFbdGhpcy5jdXJyZW50SW5kZXhdXG4gICAgY29uc3QgbWVkaWFUeXBlID0gbWVkaWFDdXJyZW50RWxlbS5kYXRhc2V0LmdhbGxlcnlJdGVtXG4gICAgY29uc3QgbWVkaWFJZCA9IG1lZGlhQ3VycmVudEVsZW0uZGF0YXNldC5nYWxsZXJ5SWQ7XG4gICAgXG4gICAgdGhpcy51cGRhdGVNaW5pbWFwSW5kaWNhdG9yKG1lZGlhSWQpXG5cbiAgICAvLyBJZiB0aGUgc2FtZSBtZWRpYSwgZG9uJ3QgZG8gYW55dGhpbmdcbiAgICBpZiAodGhpcy5lbGVtZW50cy5zbGlkZVNob3dDb250YWluZXIucXVlcnlTZWxlY3RvcihgW2RhdGEtc2xpZGVzaG93LWlkPVwiJHttZWRpYUlkfVwiXWApKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmhhc01lZGlhQmVlblNldCkge1xuICAgICAgdGhpcy5jcmVhdGVBbmRTZXRNZWRpYUVsZW1lbnQobWVkaWFDdXJyZW50RWxlbSwgbWVkaWFUeXBlKVxuICAgICAgdGhpcy5oYXNNZWRpYUJlZW5TZXQgPSB0cnVlXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc3dhcE1lZGlhRWxlbWVudChtZWRpYUN1cnJlbnRFbGVtLCBtZWRpYVR5cGUpXG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIHRoZSBVUkwgd2l0aCB0aGUgbmV3IGltYWdlIElEXG4gICAgY29uc3QgbmV3VXJsID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24pXG4gICAgbmV3VXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJtZWRpYVwiLCBtZWRpYUlkKVxuICAgIHdpbmRvdy5oaXN0b3J5LnB1c2hTdGF0ZSh7fSwgXCJcIiwgbmV3VXJsKVxuICAgIFxuICB9XG5cbiAgY3JlYXRlQW5kU2V0TWVkaWFFbGVtZW50KG1lZGlhRWxlbSwgbWVkaWFUeXBlKSB7XG4gICAgY29uc3QgbmV3RWxlbSA9IHRoaXMuY3JlYXRlTmV3TWVkaWFJdGVtKG1lZGlhVHlwZSlcbiAgICB0aGlzLnNldE1lZGlhQXR0cmlidXRlcyhuZXdFbGVtLCBtZWRpYUVsZW0sIG1lZGlhVHlwZSlcblxuICAgIHRoaXMuZWxlbWVudHMuc2xpZGVTaG93Q29udGFpbmVyLmlubmVySFRNTCA9ICcnIC8vIENsZWFyIHByZXZpb3VzIGVsZW1lbnRzXG4gICAgdGhpcy5lbGVtZW50cy5zbGlkZVNob3dDb250YWluZXIuYXBwZW5kQ2hpbGQobmV3RWxlbSlcblxuICAgIGdzYXAuZnJvbVRvKG5ld0VsZW0sIHsgY2xpcFBhdGg6IFwicG9seWdvbigwJSAxMDAlLCAxMDAlIDEwMCUsIDEwMCUgMTAwJSwgMCUgMTAwJSlcIiB9LCB7IGNsaXBQYXRoOiBcInBvbHlnb24oMCUgMCUsIDEwMCUgMCUsIDEwMCUgMTAwJSwgMCUgMTAwJSlcIiwgZHVyYXRpb246IDAuNiwgZWFzZTogXCJ6b29tXCIgfSlcbiAgfVxuXG4gIGRpc3BsYXlJbmRleCgpIHtcbiAgICB0aGlzLmVsZW1lbnRzLnNsaWRlU2hvd0NvdW50ZXIuaW5uZXJIVE1MID0gU3RyaW5nKHRoaXMuY3VycmVudEluZGV4ICsgMSkucGFkU3RhcnQoMiwgJzAnKVxuICB9XG5cbiAgc3dhcE1lZGlhRWxlbWVudChtZWRpYUVsZW0sIG1lZGlhVHlwZSkge1xuICAgIGNvbnN0IG9sZEVsZW0gPSB0aGlzLmVsZW1lbnRzLnNsaWRlU2hvd0NvbnRhaW5lci5maXJzdENoaWxkXG4gICAgY29uc3QgbmV3RWxlbSA9IHRoaXMuY3JlYXRlTmV3TWVkaWFJdGVtKG1lZGlhVHlwZSlcbiAgICB0aGlzLnNldE1lZGlhQXR0cmlidXRlcyhuZXdFbGVtLCBtZWRpYUVsZW0sIG1lZGlhVHlwZSlcblxuICAgIHRoaXMuZWxlbWVudHMuc2xpZGVTaG93Q29udGFpbmVyLmFwcGVuZENoaWxkKG5ld0VsZW0pXG5cbiAgICB0aGlzLnRsLmZyb21UbyhuZXdFbGVtLCB7IGNsaXBQYXRoOiBcInBvbHlnb24oMCUgMTAwJSwgMTAwJSAxMDAlLCAxMDAlIDEwMCUsIDAlIDEwMCUpXCIgfSwgeyBjbGlwUGF0aDogXCJwb2x5Z29uKDAlIDAlLCAxMDAlIDAlLCAxMDAlIDEwMCUsIDAlIDEwMCUpXCIsIGR1cmF0aW9uOiAwLjYsIGVhc2U6IFwiem9vbVwiIH0pXG4gICAgXG4gICAgdGhpcy50bC50byhvbGRFbGVtLCB7XG4gICAgICBjbGlwUGF0aDogXCJwb2x5Z29uKDAlIDEwMCUsIDEwMCUgMTAwJSwgMTAwJSAxMDAlLCAwJSAxMDAlKVwiLFxuICAgICAgZHVyYXRpb246IDAuNixcbiAgICAgIGVhc2U6IFwicG93ZXIyLm91dFwiLFxuICAgICAgb25Db21wbGV0ZTogKCkgPT4ge1xuICAgICAgICBvbGRFbGVtLnJlbW92ZSgpXG4gICAgICB9XG4gICAgfSwgXCItPTAuMlwiKVxuICB9XG5cbiAgc2V0dXBTY3JvbGxOYXZpZ2F0aW9uKCkge1xuICAgIGxldCB0aWNraW5nID0gZmFsc2U7XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignd2hlZWwnLCAoZSkgPT4ge1xuICAgICAgaWYgKCF0aGlzLmFsbG93U2xpZGVOYXZpZ2F0aW9uIHx8IHRpY2tpbmcpIHJldHVybjtcblxuICAgICAgdGlja2luZyA9IHRydWU7XG4gICAgICBjb25zdCBkaXJlY3Rpb24gPSBlLmRlbHRhWSA+IDAgPyAxIDogLTE7XG5cbiAgICAgIHRoaXMuY2hhbmdlTWVkaWEoZGlyZWN0aW9uKTtcblxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHRpY2tpbmcgPSBmYWxzZTtcbiAgICAgIH0sIDYwMCk7IC8vIGRlbGF5IHRvIHByZXZlbnQgb3ZlcnNjcm9sbFxuICAgIH0pO1xuICB9XG5cbiAgc2V0dXBTd2lwZU5hdmlnYXRpb24oKSB7XG4gICAgbGV0IHRvdWNoU3RhcnRYID0gMDtcbiAgICBsZXQgdG91Y2hFbmRYID0gMDtcblxuICAgIGNvbnNvbGUubG9nKCd5ZXAnKVxuXG4gICAgY29uc3QgdGhyZXNob2xkID0gNTA7IC8vIE1pbmltdW0gc3dpcGUgZGlzdGFuY2VcblxuICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuZWxlbWVudHMuc2xpZGVTaG93Q29udGFpbmVyO1xuXG4gICAgY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoZSkgPT4ge1xuICAgICAgdG91Y2hTdGFydFggPSBlLmNoYW5nZWRUb3VjaGVzWzBdLnNjcmVlblg7XG4gICAgfSk7XG5cbiAgICBjb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCAoZSkgPT4ge1xuICAgICAgdG91Y2hFbmRYID0gZS5jaGFuZ2VkVG91Y2hlc1swXS5zY3JlZW5YO1xuICAgICAgaGFuZGxlU3dpcGUoKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGhhbmRsZVN3aXBlID0gKCkgPT4ge1xuICAgICAgaWYgKCF0aGlzLmFsbG93U2xpZGVOYXZpZ2F0aW9uKSByZXR1cm47XG4gICAgICBjb25zdCBkZWx0YSA9IHRvdWNoU3RhcnRYIC0gdG91Y2hFbmRYO1xuICAgICAgXG4gICAgICBpZiAoTWF0aC5hYnMoZGVsdGEpID4gdGhyZXNob2xkKSB7XG4gICAgICAgIGNvbnN0IGRpcmVjdGlvbiA9IGRlbHRhID4gMCA/IDEgOiAtMTtcbiAgICAgICAgdGhpcy5jaGFuZ2VNZWRpYShkaXJlY3Rpb24pO1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBkaXNhYmxlU2xpZGVOYXZpZ2F0aW9uKCkge1xuICAgIHRoaXMuYWxsb3dTbGlkZU5hdmlnYXRpb24gPSBmYWxzZTtcbiAgfVxuXG4gIGVuYWJsZVNsaWRlTmF2aWdhdGlvbigpIHtcbiAgICB0aGlzLmFsbG93U2xpZGVOYXZpZ2F0aW9uID0gdHJ1ZTtcbiAgfVxuXG4gIGNyZWF0ZU5ld01lZGlhSXRlbSh0eXBlKSB7XG4gICAgY29uc3QgZWxlbSA9IHR5cGUgPT09IFwidmlkZW9cIiA/IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ZpZGVvJykgOiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKVxuICAgIGVsZW0uY2xhc3NMaXN0LmFkZCgnc2xpZGVzaG93LW1lZGlhX19pdGVtJylcbiAgICByZXR1cm4gZWxlbVxuICB9XG5cbiAgc2V0TWVkaWFBdHRyaWJ1dGVzKGVsZW0sIG1lZGlhRWxlbSwgbWVkaWFUeXBlKSB7XG4gICAgY29uc3QgbWVkaWFJZCA9IG1lZGlhRWxlbS5kYXRhc2V0LmdhbGxlcnlJZFxuXG4gICAgZWxlbS5zZXRBdHRyaWJ1dGUoJ2RhdGEtc2xpZGVzaG93LWlkJywgbWVkaWFJZClcblxuICAgIGlmIChtZWRpYVR5cGUgPT09IFwidmlkZW9cIikge1xuICAgICAgZWxlbS5zZXRBdHRyaWJ1dGUoJ2F1dG9wbGF5JywgJycpXG4gICAgICBlbGVtLnNldEF0dHJpYnV0ZSgnbXV0ZWQnLCAnJylcbiAgICAgIGVsZW0uc2V0QXR0cmlidXRlKCdsb29wJywgJycpXG5cbiAgICAgIGNvbnN0IHNvdXJjZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NvdXJjZScpXG4gICAgICBzb3VyY2Uuc3JjID0gbWVkaWFFbGVtLnF1ZXJ5U2VsZWN0b3IoXCJzb3VyY2VcIikuc3JjXG4gICAgICBzb3VyY2UudHlwZSA9IFwidmlkZW8vbXA0XCJcbiAgICAgIGVsZW0uYXBwZW5kQ2hpbGQoc291cmNlKVxuICAgIH0gZWxzZSB7XG4gICAgICBlbGVtLnNyYyA9IG1lZGlhRWxlbS5kYXRhc2V0LmdhbGxlcnlTcmNcbiAgICAgIGVsZW0uYWx0ID0gbWVkaWFFbGVtLmFsdCB8fCBcIkdhbGxlcnkgSW1hZ2VcIlxuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZU1pbmltYXBJbmRpY2F0b3IobWVkaWFJZCA9IHRoaXMubWVkaWFbdGhpcy5jdXJyZW50SW5kZXhdPy5kYXRhc2V0LmdhbGxlcnlJZCkge1xuICAgIGlmICghbWVkaWFJZCkgcmV0dXJuXG4gICAgbGV0IG1pbmlNYXBSZWN0ID0gdGhpcy5lbGVtZW50cy5taW5pTWFwLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG5cbiAgICB0aGlzLmVsZW1lbnRzLm1pbmlNYXBJdGVtcy5mb3JFYWNoKChpdGVtLCBpKSA9PiB7XG4gICAgICBpZiAoaXRlbS5kYXRhc2V0LmdhbGxlcnlJZCA9PT0gbWVkaWFJZCkge1xuICAgIFxuICAgICAgICBsZXQgaXRlbVJlY3QgPSBpdGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG4gICAgICAgIFxuICAgICAgICBjb25zdCB0YXJnZXRYID0gLWl0ZW0ub2Zmc2V0TGVmdFxuICAgICAgICBjb25zdCBpbmRpY2F0b3JYcG9zID0gaXRlbVJlY3QubGVmdCAtIG1pbmlNYXBSZWN0LmxlZnRcblxuICAgICAgICBnc2FwLnRvKHRoaXMuZWxlbWVudHMubWluaU1hcEluZGljYXRvciwge1xuICAgICAgICAgIHg6IGluZGljYXRvclhwb3MsXG4gICAgICAgICAgZHVyYXRpb246IDAuNCxcbiAgICAgICAgICBlYXNlOiBcInpvb21cIlxuICAgICAgICB9KVxuXG4gICAgICAgIGdzYXAudG8odGhpcy5lbGVtZW50cy5taW5pTWFwLCB7XG4gICAgICAgICAgeDogdGFyZ2V0WCxcbiAgICAgICAgICBkdXJhdGlvbjogMC40LFxuICAgICAgICAgIGVhc2U6IFwicG93ZXIzLm91dFwiXG4gICAgICAgIH0pXG5cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnbWluaW1hcC1pdGVtLS1hY3RpdmUnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8vIENoZWNrIFVSTCBvbiBQYWdlIExvYWQgJiBPcGVuIFNsaWRlc2hvdyBpZiBOZWVkZWRcbiAgY2hlY2tVUkxGb3JTbGlkZVNob3coKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsICgpID0+IHtcbiAgICAgIGNvbnN0IHVybFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7XG4gICAgICBjb25zdCBtZWRpYUlkID0gdXJsUGFyYW1zLmdldChcIm1lZGlhXCIpO1xuICBcbiAgICAgIGlmIChtZWRpYUlkKSB7XG4gICAgICAgIGNvbnN0IG1lZGlhRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLWdhbGxlcnktaWQ9XCIke21lZGlhSWR9XCJdYCk7XG4gICAgICAgIGlmIChtZWRpYUVsZW1lbnQpIHRoaXMub3BlblNsaWRlU2hvdyh7IHRhcmdldDogbWVkaWFFbGVtZW50IH0pO1xuICAgICAgfVxuICAgIH0pXG4gIH1cbiAgXG4gIGFuaW1hdGVJbWFnZXModXNlU3Ryb2xsVHJpZ2dlciwgc2hvdyA9IHRydWUpIHtcbiAgICBsZXQgY2xpcFBhdGhQb2x5ID0gc2hvdz8gXCJwb2x5Z29uKDAlIDAlLCAxMDAlIDAlLCAxMDAlIDEwMCUsIDAlIDEwMCUpXCIgOiBcInBvbHlnb24oMCUgMTAwJSwgMTAwJSAxMDAlLCAxMDAlIDEwMCUsIDAlIDEwMCUpXCIgXG5cbiAgICBpZih1c2VTdHJvbGxUcmlnZ2VyKSB7XG4gICAgICBnc2FwLnRvKHRoaXMuZWxlbWVudHMuZ2FsbGVyeUl0ZW1zLFxuICAgICAgICB7XG4gICAgICAgICAgY2xpcFBhdGg6IGNsaXBQYXRoUG9seSxcbiAgICAgICAgICBkdXJhdGlvbjogMC42LFxuICAgICAgICAgIHNjcm9sbFRyaWdnZXI6IHtcbiAgICAgICAgICAgIHRyaWdnZXI6IHRoaXMuZWxlbWVudHMuZ2FsbGVyeUl0ZW1zLFxuICAgICAgICAgICAgc3RhcnQ6ICd0b3AgYm90dG9tJyxcbiAgICAgICAgICAgIHNjcnViOiBmYWxzZSxcbiAgICAgICAgICAgIG1hcmtlcnM6IGZhbHNlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBlYXNlOiBcInpvb21cIlxuICAgICAgICB9XG4gICAgICApXG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgZ3NhcC50byh0aGlzLmVsZW1lbnRzLmdhbGxlcnlJdGVtcyxcbiAgICAgICAge1xuICAgICAgICAgIGNsaXBQYXRoOiBjbGlwUGF0aFBvbHksXG4gICAgICAgICAgZHVyYXRpb246IDAuNixcbiAgICAgICAgICBlYXNlOiBcInpvb21cIlxuICAgICAgICB9XG4gICAgICApXG4gICAgfVxuICB9XG5cbiAgYW5pbWF0ZUFzc2V0cyh0bCwgcmVzb2x2ZSkge1xuICAgIHN1cGVyLmFuaW1hdGVBc3NldHModGwsICgpID0+IHtcbiAgICAgIHRoaXMuYW5pbWF0ZUltYWdlcyh0cnVlKVxuXG4gICAgICByZXNvbHZlKClcbiAgICB9KVxuICB9XG5cbiAgaGFuZGxlUmVzaXplID0gKCkgPT4ge1xuICAgIHRoaXMudXBkYXRlTWluaW1hcEluZGljYXRvcigpXG4gIH1cblxuICAvLyBEZWJvdW5jZSBoZWxwZXIgKGF2b2lkcyBzcGFtbWluZyBkdXJpbmcgcmVzaXplKVxuICBkZWJvdW5jZShmbiwgZGVsYXkgPSAxMDApIHtcbiAgICBsZXQgdGltZW91dFxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBjbGVhclRpbWVvdXQodGltZW91dClcbiAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGZuLCBkZWxheSlcbiAgICB9XG4gIH1cblxuICBhZGRFdmVudExpc3RlbmVycygpIHtcbiAgICBpZighdGhpcy5lbGVtZW50cy5nYWxsZXJ5SXRlbXMgfHwgIXRoaXMuZWxlbWVudHMuY2xvc2UpIHJldHVyblxuXG4gICAgZ3NhcC5zZXQodGhpcy5lbGVtZW50cy5nYWxsZXJ5SXRlbXMsIHsgY2xpcFBhdGg6IFwicG9seWdvbigwJSAxMDAlLCAxMDAlIDEwMCUsIDEwMCUgMTAwJSwgMCUgMTAwJSlcIn0pXG4gICAgXG4gICAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy5lbGVtZW50cy5nYWxsZXJ5SXRlbXMpIHx8ICh0eXBlb2YgdGhpcy5lbGVtZW50cy5nYWxsZXJ5SXRlbXMgPT09ICdvYmplY3QnKSkge1xuICAgICAgdGhpcy5tZWRpYSA9IEFycmF5LmZyb20odGhpcy5lbGVtZW50cy5nYWxsZXJ5SXRlbXMpXG4gICAgICB0aGlzLmVsZW1lbnRzLmdhbGxlcnlJdGVtcy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICB0aGlzLm9wZW5TbGlkZVNob3coZSlcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuICAgICAgXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZWxlbWVudHMuZ2FsbGVyeUl0ZW1zLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgdGhpcy5vcGVuU2xpZGVTaG93KGUpXG4gICAgICB9KVxuICAgIH1cblxuICAgIGlmKHRoaXMuZWxlbWVudHMucHJldikge1xuICAgICAgdGhpcy5lbGVtZW50cy5wcmV2LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICB0aGlzLmNoYW5nZU1lZGlhKC0xKVxuICAgICAgfSlcbiAgICB9XG5cbiAgICBpZih0aGlzLmVsZW1lbnRzLm5leHQpIHtcbiAgICAgIHRoaXMuZWxlbWVudHMubmV4dC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgdGhpcy5jaGFuZ2VNZWRpYSgxKVxuICAgICAgfSlcbiAgICB9XG5cbiAgICB0aGlzLmVsZW1lbnRzLmNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5jbG9zZVNsaWRlU2hvdygpXG4gICAgfSlcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLmRlYm91bmNlKHRoaXMuaGFuZGxlUmVzaXplKSlcbiAgfVxuXG4gIGluaXQoKSB7XG4gICAgdGhpcy5hZGRFdmVudExpc3RlbmVycygpXG4gICAgdGhpcy5jaGVja1VSTEZvclNsaWRlU2hvdygpXG4gICAgdGhpcy5zZXR1cFN3aXBlTmF2aWdhdGlvbigpXG4gICAgdGhpcy5zZXR1cFNjcm9sbE5hdmlnYXRpb24oKVxuICB9XG59IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5oID0gKCkgPT4gKFwiYjRjYTI1Y2I1OWE4YWU2OGVjN2FcIikiXSwibmFtZXMiOlsiUGFnZSIsImdzYXAiLCJzY3JvbGwiLCJDdXN0b21FYXNlIiwiR2FsbGVyeSIsImNvbnN0cnVjdG9yIiwiaWQiLCJlbGVtZW50cyIsImdhbGxlcnkiLCJnYWxsZXJ5SXRlbXMiLCJzbGlkZVNob3ciLCJwcmV2IiwibmV4dCIsImNsb3NlIiwic2xpZGVTaG93Q29udGFpbmVyIiwic2xpZGVTaG93Q291bnRlciIsIm1pbmlNYXAiLCJtaW5pTWFwSXRlbXMiLCJtaW5pTWFwSW5kaWNhdG9yIiwicmVnaXN0ZXJQbHVnaW4iLCJjcmVhdGUiLCJ0bCIsInRpbWVsaW5lIiwiY3VycmVudEluZGV4IiwibWVkaWEiLCJoYXNNZWRpYUJlZW5TZXQiLCJpc0hvdmVyZWQiLCJzY3JvbGxTcGVlZCIsImR1cGxpY2F0ZWRJdGVtcyIsImFsbG93U2xpZGVOYXZpZ2F0aW9uIiwiaW5pdCIsIm9wZW5TbGlkZVNob3ciLCJlIiwibWVkaWFFbGVtZW50IiwidGFyZ2V0IiwibWVkaWFJZCIsImRhdGFzZXQiLCJnYWxsZXJ5SWQiLCJmaW5kSW5kZXgiLCJkaXNwbGF5SW5kZXgiLCJzdG9wIiwiY2xlYXIiLCJ0byIsImNsaXBQYXRoIiwiZHVyYXRpb24iLCJlYXNlIiwib25Db21wbGV0ZSIsImNsYXNzTGlzdCIsInJlbW92ZSIsInNob3dNZWRpYSIsImVuYWJsZVNsaWRlTmF2aWdhdGlvbiIsIm9wYWNpdHkiLCJjbG9zZVNsaWRlU2hvdyIsImRpc2FibGVTbGlkZU5hdmlnYXRpb24iLCJzbGlkZVNob3dNZWRpYSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZCIsInN0YXJ0IiwiYW5pbWF0ZUltYWdlcyIsIm5ld1VybCIsIlVSTCIsIndpbmRvdyIsImxvY2F0aW9uIiwic2VhcmNoUGFyYW1zIiwiZGVsZXRlIiwiaGlzdG9yeSIsInB1c2hTdGF0ZSIsImNoYW5nZU1lZGlhIiwiZGlyZWN0aW9uIiwib2xkSW5kZXgiLCJsZW5ndGgiLCJpc0FjdGl2ZSIsIm1lZGlhQ3VycmVudEVsZW0iLCJtZWRpYVR5cGUiLCJnYWxsZXJ5SXRlbSIsInVwZGF0ZU1pbmltYXBJbmRpY2F0b3IiLCJjcmVhdGVBbmRTZXRNZWRpYUVsZW1lbnQiLCJzd2FwTWVkaWFFbGVtZW50Iiwic2V0IiwibWVkaWFFbGVtIiwibmV3RWxlbSIsImNyZWF0ZU5ld01lZGlhSXRlbSIsInNldE1lZGlhQXR0cmlidXRlcyIsImlubmVySFRNTCIsImFwcGVuZENoaWxkIiwiZnJvbVRvIiwiU3RyaW5nIiwicGFkU3RhcnQiLCJvbGRFbGVtIiwiZmlyc3RDaGlsZCIsInNldHVwU2Nyb2xsTmF2aWdhdGlvbiIsInRpY2tpbmciLCJhZGRFdmVudExpc3RlbmVyIiwiZGVsdGFZIiwic2V0VGltZW91dCIsInNldHVwU3dpcGVOYXZpZ2F0aW9uIiwidG91Y2hTdGFydFgiLCJ0b3VjaEVuZFgiLCJjb25zb2xlIiwibG9nIiwidGhyZXNob2xkIiwiY29udGFpbmVyIiwiY2hhbmdlZFRvdWNoZXMiLCJzY3JlZW5YIiwiaGFuZGxlU3dpcGUiLCJkZWx0YSIsIk1hdGgiLCJhYnMiLCJ0eXBlIiwiZWxlbSIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJzb3VyY2UiLCJzcmMiLCJnYWxsZXJ5U3JjIiwiYWx0IiwibWluaU1hcFJlY3QiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJmb3JFYWNoIiwiaXRlbSIsImkiLCJpdGVtUmVjdCIsInRhcmdldFgiLCJvZmZzZXRMZWZ0IiwiaW5kaWNhdG9yWHBvcyIsImxlZnQiLCJ4IiwiY2hlY2tVUkxGb3JTbGlkZVNob3ciLCJ1cmxQYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJzZWFyY2giLCJnZXQiLCJ1c2VTdHJvbGxUcmlnZ2VyIiwic2hvdyIsImNsaXBQYXRoUG9seSIsInNjcm9sbFRyaWdnZXIiLCJ0cmlnZ2VyIiwic2NydWIiLCJtYXJrZXJzIiwiYW5pbWF0ZUFzc2V0cyIsInJlc29sdmUiLCJoYW5kbGVSZXNpemUiLCJkZWJvdW5jZSIsImZuIiwiZGVsYXkiLCJ0aW1lb3V0IiwiY2xlYXJUaW1lb3V0IiwiYWRkRXZlbnRMaXN0ZW5lcnMiLCJBcnJheSIsImlzQXJyYXkiLCJmcm9tIiwiZWxlbWVudCJdLCJzb3VyY2VSb290IjoiIn0=